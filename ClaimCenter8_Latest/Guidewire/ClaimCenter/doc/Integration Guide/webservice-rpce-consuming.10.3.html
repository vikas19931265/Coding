<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Dynamic SOAP Authentication Handlers</title>
    <link rel="StyleSheet" href="css/webservice-rpce-consuming.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>ClaimCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="p-webservices.html#2074722">Web Services</a> : <a class="WebWorks_Breadcrumb_Link" href="webservice-rpce-consuming.10.1.html#2074722">Calling RPCE Web Services from Gosu</a> : <a class="WebWorks_Breadcrumb_Link" href="webservice-rpce-consuming.10.2.html#2074722">Calling External RPCE Web Services</a> : Dynamic SOAP Authentication Handlers</span></div>
    <hr align="left" />
    <blockquote>
      <h4 class="H2B_-_Heading_2_Break"><a name="2074722">Dynamic SOAP Authentication Handlers</a></h4>
      <div class="B_-_Body"><a name="2074723">If you need to connect to a SOAP API that does not require authentication, your code can simply connect to the service as discussed in previous sections. Similarly, to connect to a web service set up in Studio with HTTP authentication, connect to it directly using the code specified in previous sections. To set up authentication in Studio, see </a><a href="javascript:WWHClickedPopup('config', 'studio_web_services.12.1.html#1178213', '');" title="Working with Web Services">“Working with Web Services” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'studio_web_services.12.1.html#1178213', '');" title="Working with Web Services">Configuration Guide</a></span>. You can set up various combinations of username and password, varying by the system <span class="cv_-_computer_voice">server</span> and <span class="cv_-_computer_voice">env</span> variables.</div>
      <div class="B_-_Body"><a name="2074727">However, if you need to dynamically generate name and/or password or other authentication criteria, you can send your authentication information with a SOAP request. At an implementation level, this typically involves adding </a><span class="e_-_emphasis">headers</span> to the SOAP request. You can add SOAP headers with <span class="e_-_emphasis">API&nbsp;handlers</span>, which are blocks of code associated with a web service interface. In a typical case, the block of code embeds authentication information in the web service API call by adding SOAP headers. </div>
      <div class="B_-_Body"><a name="2074729">The authentication handlers customize authentication at the SOAP header level, which is in the HTTP </a><span class="e_-_emphasis">request</span> <span class="e_-_emphasis">content</span>. Authentication handlers cannot dynamically generate HTTP <span class="e_-_emphasis">request header</span> authentication information. You can vary SOAP user names and passwords by server environments or server IDs in a cluster. Studio has built-in configuration options to create setting groups for this purpose. See <a href="javascript:WWHClickedPopup('config', 'studio_web_services.12.1.html#1178213', '');" title="Working with Web Services">“Working with Web Services” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'studio_web_services.12.1.html#1178213', '');" title="Working with Web Services">Configuration Guide</a></span>. However, in Studio you cannot dynamically set the username and password for HTTP authentication other than varying based on server ID and environment variables. To do more complex dynamic generation of authentication information, use an API handler.</div>
      <div class="B_-_Body"><a name="2074733">A handler operation can trigger before the SOAP call, after the SOAP call returns, or both. The primary use of API handlers is to add SOAP headers to the outgoing request SOAP request. The ability to trigger an action before a method call, after a method call, or both, is similar to Gosu </a><span class="e_-_emphasis">interceptors</span>. See <a href="javascript:WWHClickedPopup('gosu', 'annotations.16.1.html#1433440', '');" title="Annotations">“Annotations” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('gosu', 'annotations.16.1.html#1433440', '');" title="Annotations">Gosu Reference Guide</a></span> for more information.</div>
      <div class="B_-_Body"><a name="2074738">After you choose a handler type, instantiate a handler. In the constructor, pass the appropriate authentication credentials. Next, add it to an API by call the </a><span class="cv_-_computer_voice">addHandler</span> method on the web service interface. </div>
      <div class="B_-_Body"><a name="2074739">The following sections show how use each built-in type of handler as well how to create your own handler.</a></div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="2074740">Dynamic Transaction Authentication</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2074742">Some web services require transaction identifiers (transaction IDs) in the </a><span class="cv_-_computer_voice">GW_TRANSACTION_ID_PROPERTY</span> header of each request.</div>
      <div class="B_-_Body"><a name="2074745">Use the handler called </a><span class="cv_-_computer_voice">GWTransactionIDHandler</span> to pass a transaction ID to the external API. The constructor takes one argument, the transaction ID.</div>
      <div class="B_-_Body"><a name="2074746">For example:</a></div>
      <PRE class="CF_-_Code_First_Line"><a name="2074747">var api = new soap.MyRemoteWebService.api.ServiceName()</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074749">api.addHandler(new GWTransactionIDHandler("123451"))</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074750">api.myMethodName()</a></PRE>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="2074751">Dynamic Guidewire Authentication</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2074752">Suppose you have more than one Guidewire application and want to write custom APIs for them to communicate. For typical cases, simply set up the authentication in the standard </a><span class="ui_-_UI_element">Web&nbsp;Service</span> editor in Studio. However, if you did not specify Guidewire authentication in the connection setup configuration, you can authenticate dynamically. The built-in handler called <span class="cv_-_computer_voice">GWAuthenticationHandler</span> lets you authenticate dynamically. Similarly, if you store this authentication information in a hidden or generate it dynamically in some other way, authenticate the connection using <span class="cv_-_computer_voice">GWAuthenticationHandler</span>.</div>
      <div class="B_-_Body"><a name="2074755">You can use this handler to connect to a web service on this server using the local endpoint system. See </a><a href="javascript:WWHClickedPopup('integration', 'webservice-rpce-consuming.10.2.html#2074695', '');" title="Calling External RPCE Web Services">“Local RPCE SOAP Endpoints in Gosu”</a>. That section includes more information and an example that uses this authentication system.</div>
      <div class="B_-_Body"><a name="2074757">Use </a><span class="cv_-_computer_voice">GWAuthenticationHandler</span> to authenticate the external API with Guidewire authentication. All methods on the API object authenticate with the given credentials. It takes two arguments, the username and the password, as shown in the example in this section:</div>
      <PRE class="CF_-_Code_First_Line"><a name="2074758">var api = new soap.MyRemoteWebService.api.ServiceName()</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074759">api.addHandler(new GWAuthenticationHandler("su", "gw"))</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074760">api.Methodname()</a></PRE>
      <div class="B_-_Body"><a name="2074762">Your web service calls to this </a><span class="cv_-_computer_voice">api</span> object include the <span class="cv_-_computer_voice">GW_AUTHENTICATION_USERNAME_PROPERTY</span> and <span class="cv_-_computer_voice">GW_AUTHENTICATION_USERNAME_PROPERTY</span> headers. </div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="2074764">Writing Your Own Handlers</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2074765">In some cases you might need to access a web service that requires other headers. Insert arbitrary headers by making your own handler. To do this, write your own implementation of the </a><span class="cv_-_computer_voice">Handler</span> interface and insert whatever headers you need.</div>
      <h6 class="HS_-_Head_Sub"><a name="2074766">To create a custom handler</a></h6>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><span class="ri_-_run_in_header"><a name="2074767">Learn what custom headers you need</a></span> – Sometimes this is a fixed header name. Sometimes this is dynamic value. Check the WSDL data to learn the headers. For example, suppose you see something like this in the WSDL for the service:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="CS_-_Code_Single_Line"><a name="2074768">&lt;soap:header message="tns:GetClientTokenUserInfoHeader" part="UserInfoHeader" use="literal"/&gt;</a></div>
      <div class="LP_-_List_Para"><a name="2074769">This indicates that you need the header </a><span class="cv_-_computer_voice">tns:GetClientTokenUserInfoHeader</span>.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="2074770">Learn what custom data you need to insert in that header</a></span> – Sometimes this is a fixed value. Sometimes this is dynamic, perhaps encoded within the WSDL data. Sometimes this is simple text, such as a user ID, but it might be an entire complex structure. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="2074771">Create a custom CallHandler implementation</a></span> – Create a new call handler that inserts custom headers into an outgoing web services request. If you call a method on the web service interface, Gosu calls the handler. Define your own custom constructors that take authentication information or other important information. To embed static information into the request, encode authentication information directly into a handler class whose constructor takes no arguments.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="2074775">Add the handler to a web service API object</a></span> – Attach the handler to the web service interface:</div>
            </td>
          </tr>
        </table>
      </div>
      <PRE class="CF_-_Code_First_Line"><a name="2074776">var api = new soap.MyRemoteWebService.api.ServiceName()</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074777">api.addHandler(new MyHandlerClass("su", "gw"))</a></PRE>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="2074778">Call methods on the web service API object</a></span> – Simply use the<span class="ri_-_run_in_header"> </span>API by calling methods on the service object<span class="ri_-_run_in_header">:</span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="CS_-_Code_Single_Line"><a name="2074779">api.theMethodname()</a></div>
      <div class="B_-_Body"><a name="2074780">There are two required methods on the </a><span class="cv_-_computer_voice">CallHandler</span> interface. The most important method is the <span class="cv_-_computer_voice">beforeRequest</span> method. Its last argument is a list of headers. You can call <span class="cv_-_computer_voice">headers.setHeader(...)</span> to append new outgoing headers to each request. One special requirement of this method is that the header name is not simply a <span class="cv_-_computer_voice">String</span> value but a two-part value called a qualified name (<span class="cv_-_computer_voice">QName</span>) object. A <span class="cv_-_computer_voice">QName</span> has two parts, the namespace and the name. A <span class="cv_-_computer_voice">QName</span> concatenates these two parts into one <span class="cv_-_computer_voice">String</span> separated by a colon in the resulting XML. Create one of these by passing to the <span class="cv_-_computer_voice">QName</span> constructor the two parts of the qualified name. </div>
      <div class="B_-_Body"><a name="2074781">For example, to add the header with name </a><span class="cv_-_computer_voice">tns:GetClientTokenUserInfoHeader</span>, you can use the code:</div>
      <div class="CS_-_Code_Single_Line"><a name="2074782">var qn = new QName("tns", "GetClientTokenUserInfoHeader")</a></div>
      <div class="B_-_Body"><a name="2074783">Next, you can add a header using this object and a value to add. For example:</a></div>
      <div class="CS_-_Code_Single_Line"><a name="2074784">headers.setHeader( qn,  "my custom header value")</a></div>
      <div class="B_-_Body"><a name="2074785">For the header argument to this method, you can pass a complex object that maps to a SOAP entity rather than a simple </a><span class="cv_-_computer_voice">String</span> value. The WSDL for the service, define all valid SOAP entities for that service.</div>
      <div class="B_-_Body"><a name="2074786">Trigger this code in the </a><span class="cv_-_computer_voice">beforeRequest</span> method of your call handler with the following method signature:</div>
      <div class="CS_-_Code_Single_Line"><a name="2074787">beforeRequest(opName: String, args: Object[], headers : OutboundHeaders)</a></div>
      <div class="B_-_Body"><a name="2074788">You can use a compact Gosu syntax to create a subclass of </a><span class="cv_-_computer_voice">CallHandler</span> without naming the subclass. This uses the Gosu feature anonymous subclasses, which means in-line subclasses without names. Use anonymous subclasses to create and use your handler with code such as the following example:</div>
      <PRE class="CF_-_Code_First_Line"><a name="2074789">var api = new soap.MyRemoteWebService.api.ServiceName()</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074790">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074791">var userHeader = "my userHeader" // this example assumes a string value for the header</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074792">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074793">var myHandler = new CallHandler(){ </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074794">  function beforeRequest(opName: String, args: Object[], headers : OutboundHeaders){</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074795">    headers.setHeader( new QName("tns", "GetClientTokenUserInfoHeader"),  userHeader)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074796">  }</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074797">  function afterRequest(opName: String, args: Object, headers : InboundHeaders){}</a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="2074798">}</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074799">api.addHandler(myHandler)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074800">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2074801">// use it...</a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="2074802">api.Methodname()</a></PRE>
      <div class="B_-_Body"><a name="2074806">For more information, see </a><a href="javascript:WWHClickedPopup('gosu', 'classes.12.6.html#2450606', '');" title="Inner Classes">“Inner Classes” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('gosu', 'classes.12.6.html#2450606', '');" title="Inner Classes">Gosu Reference Guide</a></span>.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>