<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Message Destination Overview</title>
    <link rel="StyleSheet" href="css/eventsmessaging.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>ClaimCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="p-messaging.html#3006454">Messaging</a> : <a class="WebWorks_Breadcrumb_Link" href="eventsmessaging.27.01.html#3006454">Messaging and Events</a> : Message Destination Overview</span></div>
    <hr align="left" />
    <blockquote>
      <h3 class="H1_-_Heading_1"><a name="3006454">Message Destination Overview</a></h3>
      <div class="B_-_Body"><a name="3006456">To represent each external system that receives a message, you must define a </a><span class="e_-_emphasis">messaging destination</span>. Typically, a destination represents a distinct remote system. However, you could use destinations to represent different remote APIs or different message types to send from ClaimCenter business rules.</div>
      <div class="B_-_Body"><a name="4256478">Carefully choose how to structure your messaging code. For example, if there are several related remote systems or APIs, you must choose whether they are logically one messaging destination or multiple destinations. Your choice affects messaging ordering. The ClaimCenter messaging system ensures there is no more than one in-flight message per primary object per destination. This means that the definition of a destination is important for message ordering and multithreading. See </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.07.html#4253049', '');" title="Message Ordering and Multi-Threaded Sending">“Message Ordering and Multi-Threaded Sending”</a>.</div>
      <div class="B_-_Body"><a name="3754759">Each destination specifies a list of events for which it wants notifications and various other configuration information. Additionally, a destination encapsulates a list of your plugins that perform its main destination functions:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="3754760">Message preparation</a></span> – (Optional) If you need message preparation before sending, write a plugin that implements the message request (<span class="cv_-_computer_voice">MessageRequest</span>) plugin interface. For example, this plugin might take simple name/value pairs stored in the message payload and construct an XML message in the format required by a transport or final message recipient. If the destination requires no special message preparation, omit the request plugin entirely for the destination. For implementation details and optional post-send processing, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.11.html#3110432', '');" title="Implementing Messaging Plugins">“Implementing a Message Request Plugin”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="4042221">Message transport</a></span> – (Required) The main task of a destination is to send messages to an external system. Its underlying protocol might be an external message queue, web service request to external systems, FTP, or a proprietary legacy protocol. You actually send your messages in your own implementation of the <span class="cv_-_computer_voice">MessageTransport</span> plugin interface. Every destination must provide a message transport plugin implementation. Multiple messaging destinations might use the same messaging transport plugin implementation if they really do use the underlying transport code. For implementation details, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.11.html#3715746', '');" title="Implementing Messaging Plugins">“Implementing a Message Transport Plugin”</a>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="3006471">Message reply handling</a></span> – (Required only if asynchronous) If a destination requires an asynchronous callback for acknowledgements, implement the <span class="cv_-_computer_voice">MessageReply</span> plugin. If the destination requires no asynchronous acknowledgement, omit the reply plugin. For implementation details, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.11.html#3110489', '');" title="Implementing Messaging Plugins">“Implementing a Message Reply Plugin”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3656927">After you write code that implements your messaging plugins, register them in Studio. When registering an implementation of new messaging plugin, Studio prompts you for a plugin name. The plugin name is different from the implementation class name. The plugin name is a short arbitrary name that identifies a plugin implementation. Studio only prompts you for a plugin name for plugin interfaces that support more than one implementation.</a></div>
      <div class="B_-_Body"><a name="4042263">Use that plugin name to configure the messaging destination in the Messaging editor in Studio to register each destination. For details and examples of this editor, see </a><a href="javascript:WWHClickedPopup('config', 'studio_messaging.15.1.html#1178213', '');" title="Using the Messaging Editor">“Using the Messaging Editor” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'studio_messaging.15.1.html#1178213', '');" title="Using the Messaging Editor">Configuration Guide</a></span>. </div>
      <div class="B_-_Body"><a name="4041536">For more information about plugins, see </a><a href="javascript:WWHClickedPopup('integration', 'plugins.15.01.html#2013370', '');" title="Plugin Overview">“Plugin Overview”</a>.</div>
      <div class="B_-_Body"><a name="3110364">To create new destinations, configure the messaging registry to specify the list of destinations, each of which includes the following information:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4042323">The </a><span class="e_-_emphasis">plugin name</span> class for a <span class="cv_-_computer_voice">MessageTransport</span> plugin in Java or Gosu.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3110366">Optionally, the </a><span class="e_-_emphasis">plugin name</span> for the implementation of a <span class="cv_-_computer_voice">MessageRequest</span> plugin. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3110344">Optionally, the </a><span class="e_-_emphasis">plugin name</span> for the implementation of a <span class="cv_-_computer_voice">MessageReply</span> plugin.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ui_-_UI_element"><a name="3006491">Retry Interval</a></span> – The amount of time in milliseconds (<span class="cv_-_computer_voice">initialretryinterval</span>) after a retryable error to retry a sending a message.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ui_-_UI_element"><a name="3006493">Max Retries</a></span> – The number of automatic retries (<span class="cv_-_computer_voice">maxretries</span>) to attempt before suspending the messaging destination<span class="e_-_emphasis">.</span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ui_-_UI_element"><a name="3006494">Backoff Multiplier</a></span> – The amount to increase the time between retries, specified as a multiplier of the time previously attempted. For example, if the last retry time attempted was 5 minutes, and the multiplier (<span class="cv_-_computer_voice">retrybackoffmultiplier</span>) is set to 2, ClaimCenter attempts the next retry in 10 minutes.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ui_-_UI_element"><a name="3006499">Event Names</a></span> – A list of events to listen for, by name. Each event triggers the Event Fired rule set for that destination. To specify that the destination wants to listen for all events, use the special event name string <span style="font-family: &quot;Lucida Sans Typewriter&quot;; font-size: 7.0pt">"(\w)*"</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ui_-_UI_element"><a name="3006500">Destination ID</a></span>, which typically you use in your Event Fired rules to check the intended messaging destination for the event notification. If five different destinations request an event that fires, the Event Fired rule set triggers five times for that event. They differ only in the <span class="e_-_emphasis">destination&nbsp;ID</span> property (<span class="cv_-_computer_voice">destID</span>) within each message context object. Each messaging plugin implementation must have a <span class="cv_-_computer_voice">setDestinationID</span> method. This method allows your destination to get its own destination ID to store it in a private variable. Your code can use the stored value for logging messages or send it to integration systems so that they can programmatically suspend/resume the destination if necessary.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3594177">The valid range for your destination IDs is 0 through 63, inclusive. Guidewire reserves all other destination IDs for built-in destinations such as the email transport destination.</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ui_-_UI_element"><a name="4281040">Alternative Primary Entity</a></span> – See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4207620', '');" title="Messaging Overview">“Primary Entity and Primary Object”</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ui_-_UI_element"><a name="4281044">Strict Mode</a></span> – See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.07.html#4084669', '');" title="Message Ordering and Multi-Threaded Sending">“How Destination Settings Affects Ordering”</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ui_-_UI_element"><a name="4041561">Poll interval</a></span> – Each messaging destination pulls messages from the database (from the send queue) in batches of messages on the batch server. The application does not query again until this amount of time passes. Use this field to set the value of the polling interval to wait. After the current round of sending, the messaging destination sleeps for the reminder of the poll interval. If the current round of sending takes longer than the poll interval, then the thread does not sleep at all and continues to the next round of querying and sending. See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.07.html#4253049', '');" title="Message Ordering and Multi-Threaded Sending">“Message Ordering and Multi-Threaded Sending”</a> for details on how the polling interval works. If your performance issues primarily relate to many messages per primary object per destination, then the polling interval is the most important messaging performance setting. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ui_-_UI_element"><a name="4257683">Sender Threads </a></span>– To send messages associated with a primary object, ClaimCenter can create multiple sender threads for each messaging destination to distribute the workload. These are threads that actually call the messaging plugins to send the messages. Use this field to configure the number of sender threads for safe-ordered messages. This setting is ignored for non-safe-ordered messages, since those are always handled by one thread for each destination. If your performance issues primarily relate to many messages but few messages per claim for each destination, then this is the most important messaging performance setting. For more information, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.07.html#4253049', '');" title="Message Ordering and Multi-Threaded Sending">“Message Ordering and Multi-Threaded Sending”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ui_-_UI_element"><a name="4041674">Shutdown timeout</a></span> – Messaging plugins have methods to handle the administrative commands suspend, resume, and preparing for the messaging system to shutdown. The shutdown timeout value is the length of time to wait before attempting to shutdown the messaging subsystem. For more information about suspend and shutdown actions, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.03.html#3006454', '');" title="Message Destination Overview">“Message Destination Overview”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="4041667">Manage these settings in Guidewire Studio in the Messaging editor. See </a><a href="javascript:WWHClickedPopup('config', 'studio_messaging.15.1.html#1178213', '');" title="Using the Messaging Editor">“Using the Messaging Editor” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'studio_messaging.15.1.html#1178213', '');" title="Using the Messaging Editor">Configuration Guide</a></span>.</div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="3754982">If you register a messaging plugin, you must register it in two places. First, register it in the plugin registry in the plugin editor; see </a><a href="javascript:WWHClickedPopup('config', 'studio_plugins.11.1.html#3595679', '');" title="Using the Plugins Registry Editor">“Using the Plugins Registry Editor” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'studio_plugins.11.1.html#3595679', '');" title="Using the Plugins Registry Editor">Configuration Guide</a></span>. Remember the plugin implementation name that you use. You need it to configure the messaging destination in the Messaging editor in Studio to register each destination. Next, register it in the messaging registry in the messaging editor; see <a href="javascript:WWHClickedPopup('config', 'studio_messaging.15.1.html#1178213', '');" title="Using the Messaging Editor">“Using the Messaging Editor” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'studio_messaging.15.1.html#1178213', '');" title="Using the Messaging Editor">Configuration Guide</a></span>.</div>
      <div class="B_-_Body"><a name="4248366">To write your messaging plugins, see </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.11.html#3807598', '');" title="Implementing Messaging Plugins">“Implementing Messaging Plugins”</a>.</div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="4248375">Event Fired rules and messaging plugin implementations have limitations about what data you can change. See </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4367010', '');" title="Messaging Overview">“Important Entity Data Restrictions in Messaging Rules and Messaging Plugins”</a>.</div>
      <h6 class="HS_-_Head_Sub"><a name="4248368">Sharing Plugin Classes Across Multiple Destinations</a></h6>
      <div class="B_-_Body"><a name="4248369">It is common to implement messaging plugin classes that multiple destinations share. For example, a transport plugin might manage the transport layer for multiple destinations that use that physical protocol. In such cases, be aware of the following things:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3089521">The class instantiates once for each destination. The instance is not shared across destinations.</a> However, you still must write your plugin code as threadsafe, since you might have multiple sender threads. The number of sender threads only affects safe-ordered messaging, and is a field in the Messaging editor in Studio for each destination.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3089530">Each messaging plugin instance distinguishes itself from other instances by implementing the </a><span class="cv_-_computer_voice">setDestinationID</span> method and saving the destination ID in a private class variable. Use this later for logging, exception handling, or notification e-mails. For more information, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.11.html#3760521', '');" title="Implementing Messaging Plugins">“Saving the Destination ID for Logging or Errors”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <h4 class="H2_-_Heading_2"><a name="3006549">Handling Acknowledgements</a></h4>
      <div class="B_-_Body"><a name="3006550">Due to differences in external systems and transports, there are two basic approaches for handling replies. ClaimCenter supports synchronous and asynchronous acknowledgements, although in different ways:</a></div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><span class="ri_-_run_in_header"><a name="3006554">Synchronous acknowledgement at the transport layer</a></span> – For some transports and message types, acknowledging that a message was successfully sent can happen synchronously. For example, some systems can accept messages through an HTTP request or web service API call. For such a situation, use the synchronous acknowledgement approach. The synchronous approach requires that your transport plugin <span class="cv_-_computer_voice">send</span> method actually send the message and immediately submit an acknowledgement or error. In this case, acknowledgement is straightforward using code like <span class="cv_-_computer_voice">message.reportAck(...)</span> and <span class="cv_-_computer_voice">message.reportError(...)</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3760183">Asynchronous acknowledgement</a></span> – Some transports might finish an initial process such as submitting a message on an external message queue. However in some cases, the transport must wait for a delayed reply before it can determine if the external system successfully processed the message. The transport can wait using polling or through some other type of callback. Finally, submit the acknowledgement as successful or an error. External systems that send status messages back through a message reply queue fit this category. There are several ways to handle asynchronous acknowledgements, as described later.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3222348">For asynchronous acknowledgement, the messaging system and code path is much more complex. In this case, the message transport plugin does not acknowledge the message during its main </a><span class="cv_-_computer_voice">send</span> method. </div>
      <div class="B_-_Body"><a name="3179981">The typical way to handle asynchronous replies is through a separate plugin called the message reply plugin. The message reply plugin uses a callback function that acknowledges the message at a later time. For example, suppose the destination needed to wait for a message on a special incoming messaging queue to confirm receipt of the message. The destination’s message reply plugin registers with the queue. After it receives the remote acknowledgement, the destination reports to ClaimCenter that the message successfully sent. </a></div>
      <div class="B_-_Body"><a name="3006566">One special step in asynchronous acknowledgement with a message reply plugin is setting up the callback routine’s database </a><span class="e_-_emphasis">transaction</span> information appropriately. Your code must retrieve message objects safely and commit any updated objects (the ACK itself and or additional property updates) to the ClaimCenter database. </div>
      <div class="B_-_Body"><a name="3006570">To set up the callbacks properly, Guidewire provides several interfaces, including:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="4042389">A message finder</a></span> – A class that returns a <span class="cv_-_computer_voice">Message</span> object from its message ID <span class="cv_-_computer_voice">(</span>the <span class="cv_-_computer_voice">MessageID</span> property)<span class="cv_-_computer_voice"> </span>or from its sender reference ID and destination ID (<span class="cv_-_computer_voice">SenderRefID</span> and <span class="cv_-_computer_voice">DestinationID</span>). ClaimCenter provides an instance of this class to a message reply plugin upon initialization in its <span class="cv_-_computer_voice">initTools</span> method.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="3006576">A plugin callback handler</a></span> – A class that can execute the message reply callback block in a way that ensures that any changes commit. ClaimCenter provides an instance of this class to a message reply plugin upon initialization in its <span class="cv_-_computer_voice">initTools</span> method.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="3115331">Message reply callback block interface</a></span> – The actual code that the callback handler executes is a block of code that you provide called a <span class="e_-_emphasis">message reply callback block</span>. This code block is written to a very simple interface with a single <span class="cv_-_computer_voice">run</span> method. This code can acknowledge a message and perform post-processing such as property updates or triggering custom events.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3115336">For more information about these objects and how to implement them, see </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.11.html#3110489', '');" title="Implementing Messaging Plugins">“Implementing a Message Reply Plugin”</a>. </div>
      <div class="B_-_Body"><a name="3179962">An alternative to this approach is for the external system to call a ClaimCenter web service (SOAP) API to acknowledge the message. ClaimCenter publishes a web service called </a><span class="cv_-_computer_voice">MessagingToolsAPI</span> that has an <span class="cv_-_computer_voice">ackMessage</span> method. Set up an <span class="cv_-_computer_voice">Acknowledgement</span> object with the <span class="cv_-_computer_voice">MessageID</span> set to the message ID as a <span class="cv_-_computer_voice">String</span>. If it was an error, set the <span class="cv_-_computer_voice">Error</span> property to <span class="cv_-_computer_voice">true</span>. Pass the <span class="cv_-_computer_voice">Acknowledgement</span> to the <span class="cv_-_computer_voice">ackMessage</span> method. </div>
      <div class="B_-_Body"><a name="4042563">The following diagram illustrates the destination-related plugins, associated components, along with the chronological flow of actions between elements in the system.</a></div>
      <div class="F_-_Figure"><a name="3006589"><img class="Default" src="images/eventsmessaging.27.03.1.png" style="display: inline; float: none; left: 0.0; top: 0.0" alt="" /></a></div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="3036611">Rule Sets Must Never Call Message Methods for ACK, Error, or Skip</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3961763">From within rule sets, you must never call any message acknowledgment or skipping methods such as the </a><span class="cv_-_computer_voice">Message</span> methods <span class="cv_-_computer_voice">reportAck</span>, <span class="cv_-_computer_voice">reportError</span>, or <span class="cv_-_computer_voice">skip</span>. Use those <span class="cv_-_computer_voice">Message</span> methods only within messaging plugins. </div>
      <div class="B_-_Body"><a name="4248640">This prohibition also applies to Event Fired rules.</a></div>
      <h4 class="H2_-_Heading_2"><a name="3961747">Messaging Database Transactions During Sending</a></h4>
      <div class="B_-_Body"><a name="3683613">As mentioned in </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4236951', '');" title="Messaging Overview">“Database Transactions When Creating Messages”</a>, all steps up to and including adding the message to the send queue occurs in one database transaction. This is the same database transaction that triggered the event.</div>
      <div class="B_-_Body"><a name="3683589">Additionally, there are special rules about database transactions during message sending at the destination level.</a></div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><a name="3683593">ClaimCenter calls </a><span class="cv_-_computer_voice">MessageRequest.beforeSend(...)</span> in one database transaction and commits changes assuming no exceptions occurred.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3683597">ClaimCenter calls </a><span class="cv_-_computer_voice">MessageTransport.send(...)</span> and then <span class="cv_-_computer_voice">MessageRequest.afterSend(...)</span> in one database transaction and commits changes assuming no exceptions occurred.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3683598">The </a><span class="cv_-_computer_voice">MessageReply</span> plugin, which optionally handles asynchronous acknowledgements to messages, does its work in a separate database transaction and commits changes assuming no exceptions occurred.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="3683602">Message and Entity Locking</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="4351749">At the start of each transaction, ClaimCenter locks the message object itself at a database level. This ensures that the application does not try to acknowledge a skipped message or similar conditions. If some code tries to access the message while it is locked, the calling code waits for the current lock holder to unlock the message. See the diagram earlier in this section for the timing of messaging database transactions.</a></div>
      <div class="B_-_Body"><a name="4353605">ClaimCenter can optionally lock the primary entity instance for a message if there is an associated safe ordered object for the message. The entity instance locking only affects the one entity instance, not any subobjects. Similar to message locking, if some code tries to access the message while it is locked, the calling code waits for the current lock holder to unlock the message. ClaimCenter checks the </a><span class="cv_-_computer_voice">config.xml</span> parameter <span class="cv_-_computer_voice">LockPrimaryEntityDuringMessageHandling</span>. If it is set to <span class="cv_-_computer_voice">true</span>, ClaimCenter locks the primary entity instance for that destination during the following operations:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4351839">during send</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4351840">during message reply handling </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4351841">while marking a message as skipped</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="4315833">For example, if the message is associated with a claim, during all of these operations you can request that ClaimCenter optionally lock the associated </a><span class="cv_-_computer_voice">Claim</span> object at the database level. This can reduce problems in edge cases in which other threads try to modify objects associated with this claim. </div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="4351789">This entity instance (and message) lock handling is separate from the concurrent data exception system. Be aware that concurrent data exception checking is disabled during messaging access. For important related information, see </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4367010', '');" title="Messaging Overview">“Important Entity Data Restrictions in Messaging Rules and Messaging Plugins”</a>.</div>
      <h4 class="H2_-_Heading_2"><a name="3683579">Built-In Destinations</a></h4>
      <div class="B_-_Body"><a name="3036613">Your rule sets can send standard e-mails and optionally attach the email to the claim as a document. The built-in email APIs use the built-in email destination. For more information about email configuration and API to send emails, see </a><a href="javascript:WWHClickedPopup('rules', 'rules_sending_emails.15.01.html#1005113', '');" title="Sending Emails">“Sending Emails” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('rules', 'rules_sending_emails.15.01.html#1005113', '');" title="Sending Emails">Rules Guide</a></span>. ClaimCenter always creates the built-in email destination, independent of your configuration settings. </div>
      <div class="B_-_Body"><a name="4315843">Additionally, ClaimCenter includes a built-in destination to communicate with the Insurance Services Office (ISO), which is an optional type of ClaimCenter integration. Unlike the built-in email destination, ClaimCenter creates the ISO destination only if a special line in the server </a><span class="cv_-_computer_voice">config.xml</span> file is present. For more information about ISO, see <a href="javascript:WWHClickedPopup('integration', 'isointegration.34.01.html#1810742', '');" title="Insurance Services Office (ISO) Integration">“Insurance Services Office (ISO) Integration”</a>.</div>
      <div class="B_-_Body"><a name="4315854">Similarly, ClaimCenter includes a built-in destination to communicate with the Metropolitan Reporting Bureau, which is a police accident and police report inquiry service. ClaimCenter creates the Metropolitan destination only if a special line in the server </a><span class="cv_-_computer_voice">config.xml</span> file is present. For more information about Metropolitan, see <a href="javascript:WWHClickedPopup('integration', 'metropolitan.35.1.html#1926237', '');" title="Metropolitan Reporting Bureau Integration">“Metropolitan Reporting&nbsp;Bureau Integration”</a>.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>