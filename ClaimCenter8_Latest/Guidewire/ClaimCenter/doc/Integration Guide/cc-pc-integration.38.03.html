<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Policy Search Plugin</title>
    <link rel="StyleSheet" href="css/cc-pc-integration.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>ClaimCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="p-policycontacts.html#2720958">Policy and Contact Integrations</a> : <a class="WebWorks_Breadcrumb_Link" href="cc-pc-integration.38.01.html#2720958">Claim and Policy Integration</a> : Policy Search Plugin</span></div>
    <hr align="left" />
    <blockquote>
      <h3 class="H1_-_Heading_1"><a name="2720958">Policy Search Plugin</a></h3>
      <div class="B_-_Body"><a name="2720959">The policy search plugin enables ClaimCenter users to search for a policy, review the list of possible choices, select a specific policy, and retrieve the full details of that policy. The policy details are stored with the claim as a local copy. The </a><span class="cv_-_computer_voice">IPolicySearchAdapter</span> plugin interface defines a search method and a retrieve method to support standard policy search and retrieval. This plugin defines an additional retrieval method to handle the special case of policy refresh, which is discussed later in this topic.</div>
      <div class="B_-_Body"><a name="2720961">If you use Guidewire PolicyCenter, you can use a built-in implementation of this plugin that queries PolicyCenter for policies. To use this plugin, in Studio, navigate in the </a><span class="ui_-_UI_element">Project</span> window to <span class="ui_-_UI_element">configuration</span> → <span class="ui_-_UI_element">config</span> → <span class="ui_-_UI_element">Plugins</span> and then double-click <span class="cv_-_computer_voice">IPolicySearchAdapter.gwp</span>. Then register the Gosu class <span class="cv_-_computer_voice">gw.plugin.pcintegration.pc800.PolicySearchPCPlugin</span>. For detailed instructions on this integration, see <a href="javascript:WWHClickedPopup('install', 'postinstall.7.11.html#2553930', '');" title="Enabling Integration between ClaimCenter and PolicyCenter">“Enabling Integration between ClaimCenter and PolicyCenter” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('install', 'postinstall.7.11.html#2553930', '');" title="Enabling Integration between ClaimCenter and PolicyCenter">Installation Guide</a></span>.</div>
      <div class="B_-_Body"><a name="2720966">If you use a policy administration system other than PolicyCenter, you must write your own implementation of this plugin interface.</a></div>
      <div class="B_-_Body"><a name="2720967">The base configuration of ClaimCenter also includes a demonstration version of this plugin implementation, which generates example policies. </a></div>
      <div class="B_-_Body"><a name="2720968">To understand the flow of ClaimCenter policy search, it is important to distinguish the two concepts of search versus retrieve from the context of ClaimCenter:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="2720969">Search means getting policy summaries, possibly many of them</a></span> – <span class="e_-_emphasis">Search</span> involves a call to an external system to retrieve policy summaries only, returning zero, one, two, or a very large number of results. The <span class="cv_-_computer_voice">searchPolicies</span> method receives a set of criteria and returns a subset of the full policy information, which in the typical case determines the policy that the user wants. The return result is a <span class="cv_-_computer_voice">PolicySearchResultSet</span>. This object has a <span class="cv_-_computer_voice">Summaries</span> property that contains an array of <span class="cv_-_computer_voice">PolicySummary</span> entities—an array of policy summaries.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="2720971">Retrieval means getting a single, unique, full poli</a></span>cy – The two <span class="cv_-_computer_voice">retrieve</span> methods take policy summaries that contain a specific policy number, an effective date, such as a loss date, and other search information. They retrieve a single, unique version of the policy that is effective as of a specific effective date.</div>
            </td>
          </tr>
        </table>
      </div>
      <h6 class="HS_-_Head_Sub"><a name="2720972">Typical Chronological Flow of Policy Search and Retrieval</a></h6>
      <div class="B_-_Body"><a name="2720973">The chronological flow for policy search and retrieval is as follows. In particular, note the distinction between the words search and retrieve, and between summaries and entire&nbsp;policy.</a></div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><a name="2720974">The user requests a policy search in the ClaimCenter user interface.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2720975">The policy search user interface pages use a PCF page to display the search fields. </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2720977">The PCF pages encodes user-entered data in properties in a </a><span class="cv_-_computer_voice">PolicySearchCriteria</span> object. This object is non-persistent—it is described in the ClaimCenter Data Dictionary, but has no corresponding table in the database for persisting it.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2720978">To begin the search, ClaimCenter calls </a><span class="cv_-_computer_voice">IPolicySearchAdapter.searchPolicies(PolicySearchCriteria)</span>, which returns a <span class="cv_-_computer_voice">PolicySearchResultSet</span> entity. This entity contains an array of <span class="cv_-_computer_voice">PolicySummary</span> entities to display as summaries for the user to select.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="2720979">At some future time, ClaimCenter must retrieve the entire policy, not merely the summary. At that time, ClaimCenter use the </a><span class="cv_-_computer_voice">PolicySummary</span> entity to retrieve the policy. Because of this usage, the <span class="cv_-_computer_voice">PolicySummary</span> must contain all the information required for policy retrieval.</div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="2720981">If any policy-related properties are required to retrieve a single unique policy, store that information in the </a><span class="cv_-_computer_voice">PolicySummary</span> entity. Extend the data model with new properties as necessary to store that information. For example, suppose at policy retrieval time you want to return only a single vehicle on the policy based on special search information passed to the search. Copy that information from the <span class="cv_-_computer_voice">PolicySearchCriteria</span> to each <span class="cv_-_computer_voice">PolicySummary</span> entity. For more information about returning a subset of vehicles or real estate properties, see <a href="javascript:WWHClickedPopup('integration', 'cc-pc-integration.38.03.html#2721061', '');" title="Policy Search Plugin">“Policy Retrieval Additional Information”</a>.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2720986">The selected summary is stored in the </a><span class="cv_-_computer_voice">NewClaimPolicyDescription</span> entity on the <span class="cv_-_computer_voice">NewClaimPolicy</span> object, which is part of the wizard user interface.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	6.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2720988">The user selects a summary to be retrieved by using the user interface.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	7.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2720989">To retrieve a single unique policy from the external system, ClaimCenter calls </a><span class="cv_-_computer_voice">IPolicySearchAdapter.retrievePolicyFromPolicySummary(PolicySummary)</span>. This method must return a <span class="cv_-_computer_voice">PolicyRetrievalResultSet</span>, which contains a <span class="cv_-_computer_voice">Policy</span> entity. For more details about the properties of <span class="cv_-_computer_voice">PolicyRetrievalResultSet</span>, see <a href="javascript:WWHClickedPopup('integration', 'cc-pc-integration.38.03.html#2721061', '');" title="Policy Search Plugin">“Policy Retrieval Additional Information”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	8.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2720993">If you refresh—reload—the </a><span class="cv_-_computer_voice">Policy</span> in the user interface, ClaimCenter calls <span class="cv_-_computer_voice">IPolicySearchAdapter.retrievePolicyFromPolicy(Policy)</span> with the current local version of the policy. If you need any properties from the original policy search or retrieval at the time of policy refresh, you must set them on the <span class="cv_-_computer_voice">Policy</span> entity during original policy retrieval. The <span class="cv_-_computer_voice">retrievePolicyFromPolicy</span> method can use these properties. This method also returns a <span class="cv_-_computer_voice">PolicyRetrievalResultSet</span> entity.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="2720994">Implement the plugin method </a><span class="cv_-_computer_voice">retrievePolicyFromPolicy</span> to support ClaimCenter refreshing—reloading—the policy.</div>
      <div class="B_-_Body"><a name="2720995">In other words, if you are searching for a policy, in the typical case the following methods are called:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2720996">Clicking the </a><span class="ui_-_UI_element">Search</span> button calls the <span class="cv_-_computer_voice">IPolicySearchAdapter</span> method <span class="cv_-_computer_voice">searchPolicies</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2723701">Clicking the </a><span class="ui_-_UI_element">Next</span> button to leave the first page calls the <span class="cv_-_computer_voice">IPolicySearchAdapter</span> method <span class="cv_-_computer_voice">retrievePolicyFromPolicySummary</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2720998">If you never return to the first page, there are no more calls to the plugin’s </a><span class="cv_-_computer_voice">searchPolicies</span> method. </div>
      <div class="B_-_Body"><a name="2723773">However, the path is slightly different for commercial auto and commercial property policies, for which there is an extra page in which you can select risk units. That page is titled either </a><span class="ui_-_UI_element">Select Involved Policy Vehicles</span> or <span class="ui_-_UI_element">Select Involved Policy Properties</span>. For these types of policies, the <span class="cv_-_computer_voice">retrievePolicyFromPolicySummary</span> method call happens only after you click the <span class="ui_-_UI_element">Next</span> button on that extra risk unit selection page.</div>
      <div class="B_-_Body"><a name="2723774">It does not matter what kind of search criteria you use, such as policy number or policy type. ClaimCenter calls </a><span class="cv_-_computer_voice">searchPolicies</span> once and then calls <span class="cv_-_computer_voice">retrievePolicyFromPolicySummary</span>.</div>
      <div class="B_-_Body"><a name="2721001">Every time you hit the </a><span class="ui_-_UI_element">Search</span> button, ClaimCenter calls the plugin’s <span class="cv_-_computer_voice">searchPolicies</span> method. In other words, if you do 10 searches you get 10 calls to that method.</div>
      <div class="B_-_Body"><a name="2721002">If you do not search for a policy, then you are creating a new, unverified policy. This approach does not trigger a call to the </a><span class="cv_-_computer_voice">IPolicySearchAdapter</span> at all. However, you can go back to the first page and click the <span class="ui_-_UI_element">Search</span> button to switch your approach and search for verified policies.</div>
      <div class="B_-_Body"><a name="2721003">If you searched for a policy and you return to the first page, ClaimCenter again calls </a><span class="cv_-_computer_voice">searchPolicies</span> as soon as you enter the page. If you leave the page without changing anything, there are no additional calls to the plugin. However you can deselect the policy, which triggers a call to <span class="cv_-_computer_voice">searchPolicies</span>, and then do more searches, and then change the policy. In that case, ClaimCenter calls <span class="cv_-_computer_voice">searchPolicies</span> once per search, and calls <span class="cv_-_computer_voice">retrievePolicyFromPolicySummary</span> again when you click <span class="ui_-_UI_element">Next</span>. </div>
      <h6 class="HS_-_Head_Sub"><a name="2721004">Multicurrency and Policies</a></h6>
      <div class="B_-_Body"><a name="2721005">If you use multicurrency mode, you must set the currency on the policy in the </a><span class="cv_-_computer_voice">Policy.Currency</span> property.</div>
      <h6 class="HS_-_Head_Sub"><a name="2721006">Policy Search Example and Additional Information</a></h6>
      <div class="B_-_Body"><a name="2721008">The following example shows a simple policy search plugin’s main function in Java:</a></div>
      <PRE class="CF_-_Code_First_Line"><a name="2721013">public PolicySearchResultSet searchPolicies(PolicySearchCriteria policySearchCriteria)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721014">&nbsp;&nbsp;&nbsp;throws RemoteException {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721015">&nbsp;&nbsp;int maxPolicySearchResults = 25; // must agree with MaxPolicySearchResults in config.xml</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721016">    // get whatever properties you need from the PolicySearchCriteria...    </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721017">    LossType lossType = policySearchCriteria.getLossType();</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721018">    String vin = policySearchCriteria.getVin();</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721019">    PolicyType policyType = policySearchCriteria.getPolicyType();</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721020">    String propertyCity = policySearchCriteria.getPropertyAddress().getCity();</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721021">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721022">    // [at this point, send these properties across to a remote system and get results back]</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721023">    // Populate the result object with an array of policy summaries</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721024">    // In this case just return one result</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721025">    PolicySearchResultSet policySet = (PolicySearchResultSet)EntityFactory.getInstance().newEntity(</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721026">    PolicySearchResultSet.class);</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721027">    PolicySummary policySummary =</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721028">    (PolicySummary) EntityFactory.getInstance().newEntity(PolicySummary.class);</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721029">    policySummary.setPolicyNumber("00-00001");</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721030">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721031">    // [set any other desired properties...]</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721032">    PolicySummary[] policySummaryArray = new PolicySummary[1];</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721033">    policySummaryArray[0] = policySummary;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721034">    policySet.setSummaries(policySummaryArray);</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721035">    policySet.setUncappedResultCount(1);</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721036">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721037">    if (policySet.getUncappedResultCount() &gt; maxPolicySearchResults) {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721038">      policySet.setResultsCapped(true);</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721039">    } else {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721040">      policySet.setResultsCapped(false);</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721041">    }</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721042">    </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721043">    return policySet;</a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="2721044">  }</a></PRE>
      <div class="B_-_Body"><a name="2721046">If your code path does not support a very large number of results, you can set a maximum number of results to show. You set this number in the </a><span class="cv_-_computer_voice">MaxPolicySearchResults</span> configuration parameter in the <span class="cv_-_computer_voice">config.xml</span> file. In the default configuration, this parameter is set to 25. This setting affects only the number of rows that ClaimCenter shows. The plugin must observe the same limitation during search. Never return more than that maximum number of results.</div>
      <div class="B_-_Body"><a name="2721049">Set the </a><span class="cv_-_computer_voice">PolicySearchResultSet.UncappedResultCount</span> property to the number of results found according to the search criteria, even if this number exceeds the number of results actually returned in the result set. Also set the <span class="cv_-_computer_voice">PolicySearchResultSet.ResultsCapped</span> property to <span class="cv_-_computer_voice">true</span>. If you do so, the ClaimCenter user interface can show a message that informs the user when there are “too many results found to display”.</div>
      <div class="B_-_Body"><a name="2721054">You can also add as many additional search criteria for policy searches as you want, as follows:</a></div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><a name="2721056">Extend the </a><span class="cv_-_computer_voice">PolicySearchCriteria</span> object’s data model with new extension properties just like you would extend the data model of any other ClaimCenter entity.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2721057">If appropriate, modify the PCF pages to prompt for new user data that relate to those properties. Alternatively, the new search criteria could be set programmatically based on some other factors other than new user data. For instance, the context within the ClaimCenter user interface could be such a factor.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2724143">Alter the PCF files appropriately to set these extension properties from form field data.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2724144">Sometimes policies have a very large number of insured risks, such as a large number of insured vehicles or buildings. In some cases you might need details only for a specific risk involved in the claim. The search criteria can identify the specific risk, for example, by passing a vehicle’s Vehicle Identification Number (VIN). By adding this search criterion, the policy search plugin can return only the coverages for that risk with the policy summary. If the plugin does not use some search criteria, ignore that search criteria data. It might be appropriate to remove those search fields from the user interface if they are always ignored.</a></div>
      <h6 class="HS_-_Head_Sub"><a name="2721061">Policy Retrieval Additional Information</a></h6>
      <div class="B_-_Body"><a name="2721062">As discussed earlier, </a><span class="e_-_emphasis">policy retrieval</span> refers to returning a single policy, rather than a list of matches. Refer to the chronological flow for how this happens in a typical search and retrieval.</div>
      <div class="B_-_Body"><a name="2721064">The return result of the </a><span class="cv_-_computer_voice">retrievePolicyFromPolicySummary</span> plugin method is an entity called <span class="cv_-_computer_voice">PolicyRetrievalResultSet</span>. It has properties of its own but is mostly a shell for a <span class="cv_-_computer_voice">Policy</span> entity within the <span class="cv_-_computer_voice">PolicyRetrievalResultSet.Result</span> property. </div>
      <div class="B_-_Body"><a name="2721065">Once this method retrieves the full details for a policy, it creates a new </a><span class="cv_-_computer_voice">Policy</span> object and populates its properties from data from the external system. The method adds that to a new <span class="cv_-_computer_voice">PolicyRetrievalResultSet</span> entity and returns it. </div>
      <div class="B_-_Body"><a name="2721066">The </a><span class="cv_-_computer_voice">Policy</span> object is a fairly complicated object with a lot of subobjects that must be populated. One aspect that is particularly difficult is associating contacts—people and companies—as the insured, as the agent, as interested parties, and so on. These associations are set by linking the contact to the policy and describing the ways in which the contact is related as a set of roles. Refer to the ClaimCenter Data Dictionary for the complete set of properties on the <span class="cv_-_computer_voice">Policy</span> entity.</div>
      <div class="B_-_Body"><a name="2721067">There are three possible outcomes of a policy retrieval, and the cases can be distinguished by values in the </a><span class="cv_-_computer_voice">PolicyRetrievalResultSet</span>:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="2721068">Successful</a></span> – The retrieval parameters map to a single, unique policy. The result entity has a <span class="cv_-_computer_voice">Result</span> property that contains a <span class="cv_-_computer_voice">Policy</span> entity, rather than <span class="cv_-_computer_voice">null</span>. Also, the result entity has a <span class="cv_-_computer_voice">NotUnique</span> property set to <span class="cv_-_computer_voice">false</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="2721069">Unsuccessful, multiple matches</a></span> – Unsuccessful because retrieval parameters map to multiple policies. The result entity has a <span class="cv_-_computer_voice">Result</span> property that contains a <span class="cv_-_computer_voice">Policy</span> entity, rather than <span class="cv_-_computer_voice">null</span>. The result entity has a <span class="cv_-_computer_voice">NotUnique</span> property set to <span class="cv_-_computer_voice">true</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="2721070">Unsuccessful, no match</a></span> – Unsuccessful, because retrieval parameters do not map to any policies. The result entity has a <span class="cv_-_computer_voice">Result</span> property that contains <span class="cv_-_computer_voice">null</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2721071">One way to implement policy retrieval is to return the entire policy, including all subobjects. However, you can choose to save bandwidth and return only a subset of the vehicles or real estate properties. Perhaps return only objects included in the original search criteria that triggered the search,</a> the summary of which a user clicked on, and thus triggered a retrieval. For example, if a search was triggered based on a specific vehicle, that information can be used only to retrieve that vehicle and not other vehicles on the policy. If you want to do this, be careful to note the following special properties on the <span class="cv_-_computer_voice">Policy</span> entity:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2721072">If a policy insures vehicles, your plugin can return a subset of vehicles, perhaps only one vehicle. If you return a subset of vehicles, set the </a><span class="cv_-_computer_voice">Policy.TotalVehicles</span> property to the actual number of insured vehicles. Do not simply set it to the number of vehicles in <span class="cv_-_computer_voice">Policy.Vehicles</span>. Setting the total correctly allows the user interface to notice this difference between the two numbers. The application shows a message saying that not all vehicles on the policy are available in ClaimCenter. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2721074">If a policy insures real estate properties, your plugin can return a subset of real estate properties, perhaps only one real estate property. If you return a subset of properties, set the </a><span class="cv_-_computer_voice">Policy.TotalProperties</span> property to the actual number of insured real estate properties. Do not set it to the number of real estate properties in <span class="cv_-_computer_voice">Policy.Properties</span>. Setting the total correctly causes the user interface to show the difference between the two numbers. The application shows a message saying that not all real estate properties on the policy are available in ClaimCenter. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2721076">The following example shows what to do in the policy retrieval plugin implemented in Gosu:</a></div>
      <PRE class="CF_-_Code_First_Line"><a name="2721077">override function retrievePolicyFromPolicySummary( policySummary : PolicySummary ) :</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721078">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PolicyRetrievalResultSet</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721079">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721080">&nbsp;&nbsp;var p = new Policy()</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721081">&nbsp;&nbsp;p.policyNumber = "123"</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721082">&nbsp;&nbsp;p.policyType = PolicyType.TC_AUTO_PER</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721083">&nbsp;&nbsp;p.policyStatus = PolicyStatus.TC_EXPIRED</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721084">&nbsp;&nbsp;p.isVerified = true</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721089">&nbsp;&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721090">&nbsp;&nbsp;var insured = new Person();</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721091">&nbsp;&nbsp;insured.EmailAddress1 = "insured@testmail.com"</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721092">&nbsp;&nbsp;insured.EmailAddress2 = "jdoe@central.org"</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721093">&nbsp;&nbsp;insured.FirstName = "insured_firstname"</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721094">&nbsp;&nbsp;insured.HomePhone = "532-453-0989"</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721095">&nbsp;&nbsp;insured.LastName = "insured_lastname"</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721096">&nbsp;&nbsp;insured.LicenseNumber = "CL50976800"</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721097">&nbsp;&nbsp;insured.LicenseState = State.TC_CA</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721098">&nbsp;&nbsp;insured.Occupation = "Technical Writer"</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721099">&nbsp;&nbsp;insured.Preferred = Boolean.TRUE</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721100">&nbsp;&nbsp;insured.Prefix = NamePrefix.TC_MR</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721101">&nbsp;&nbsp;insured.PrimaryPhone = PrimaryPhoneType.TC_WORK;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721102">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721103">&nbsp;&nbsp;// Set all your other properties on the Policy entity.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721104">&nbsp;&nbsp;...</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721105">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721106">&nbsp;&nbsp;var policySet = new PolicyRetrievalResultSet();</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721107">&nbsp;&nbsp;policySet.NotUnique = Boolean.FALSE &nbsp;// if successful, and there is a single match</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721108">&nbsp;&nbsp;policySet.Result = p</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721109">&nbsp;&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721110">&nbsp;&nbsp;// Return the result set.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2721111">&nbsp;&nbsp;return policySet</a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="2721112">}</a></PRE>
      <h4 class="H2_-_Heading_2"><a name="2721114">Modifying New Claim Wizard to Reload Policy</a></h4>
      <div class="B_-_Body"><a name="2721115">The New Claim Wizard retrieves policy information from an external system. On the first page of the wizard the user typically does a policy search. ClaimCenter searches an external system for a policy for the new claim or creates a new one, based on the current policy description. If the policy description matches the claim's current policy, the wizard’s </a><span class="cv_-_computer_voice">setPolicy</span> method does nothing. </div>
      <div class="B_-_Body"><a name="2721116">The search uses the registered policy search plugin and returns a list of policy summaries, which are extremely simplified versions of policies. ClaimCenter shows these summaries in a list view so you can choose a policy. When you click </a><span class="ui_-_UI_element">Next</span>, the wizard asks the policy search plugin for the policy for the picked summary. ClaimCenter sets this policy as the claim's policy. </div>
      <div class="B_-_Body"><a name="2721117">However, suppose you return to the first step in the wizard and pick a new policy, and click </a><span class="ui_-_UI_element">Next</span> again. ClaimCenter must decide whether to request the policy search plugin to retrieve another policy or instead keep—reuse—the current policy. ClaimCenter makes this decision by using a method called <span class="cv_-_computer_voice">isSamePolicy</span> on a policy summary. The wizard compares the currently picked summary with the policy that is on the claim. If <span class="cv_-_computer_voice">isSamePolicy</span> returns <span class="cv_-_computer_voice">true</span>, the wizard assumes that the claim's current policy is still the one wanted. If <span class="cv_-_computer_voice">isSamePolicy</span> returns false, the wizard replaces the claim's current policy with a new one, fetched with the policy search plugin. If the user explicitly picks a different external policy, <span class="cv_-_computer_voice">isSamePolicy</span> returns <span class="cv_-_computer_voice">false</span>, which triggers ClaimCenter to refresh the policy. </div>
      <div class="B_-_Body"><a name="2721118">To decide whether two policies are the same, ClaimCenter compares a small number of fields to see if they match. By default, the set of policy summary fields ClaimCenter checks are the following: </a><span class="cv_-_computer_voice">PolicyType</span>, <span class="cv_-_computer_voice">PolicyNumber</span>, <span class="cv_-_computer_voice">EffectiveDate</span>, and <span class="cv_-_computer_voice">ExpirationDate</span>. To compare additional fields, modify the enhancement file <span class="cv_-_computer_voice">PolicySummary.gsx</span>, which implements the policy summary <span class="cv_-_computer_voice">isSamePolicy</span> method. You can make additions or removals to that array of property names to customize how ClaimCenter compares policy summaries to determine if two policies match. </div>
      <div class="B_-_Body"><a name="2721119">For example, suppose you want to assume that two policy summaries with different loss dates must always trigger refreshing the policy. Modify </a><span class="cv_-_computer_voice">isSamePolicy</span> and add <span class="cv_-_computer_voice">"LossDate"</span> to the array of <span class="cv_-_computer_voice">String</span> values that represent property names.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>