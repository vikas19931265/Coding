<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Changing Your Encryption Algorithm Later</title>
    <link rel="StyleSheet" href="css/encryption.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>ClaimCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="p-plugins.html#2388115">Plugins</a> : <a class="WebWorks_Breadcrumb_Link" href="encryption.21.1.html#2388115">Encryption Integration</a> : Changing Your Encryption Algorithm Later</span></div>
    <hr align="left" />
    <blockquote>
      <h3 class="H1_-_Heading_1"><a name="2388115">Changing Your Encryption Algorithm Later</a></h3>
      <div class="B_-_Body"><a name="2388763">You can register any number of </a><span class="cv_-_computer_voice">IEncryption</span> plugins. For an original upgrade of your database to a new encryption algorithm, you register two implementations at the same time. You might register more than two implementations if you have encrypted claim snapshots in archive databases.</div>
      <div class="B_-_Body"><a name="2388803">However, only one encryption plugin is the </a><span class="e_-_emphasis">current encryption plugin. </span>The <span class="cv_-_computer_voice">config.xml</span> configuration parameter <span class="cv_-_computer_voice">CurrentEncryptionPlugin</span> controls this setting. It specifies which encryption plugin, among potentially multiple implementations, is the current encryption algorithm for the main database. Set the parameter to the plugin name, not the class name nor the encryption ID, for the current encryption plugin.</div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="2388120">When you use the Plugins editor in Studio to add an implementation of </a><span class="cv_-_computer_voice">IEncryption</span>, Studio prompts you for a text value to use as the plugin name for this implementation. Guidewire strongly recommends you set the plugin name for encryption plugins to names that describe the algorithm. For example, <span class="cv_-_computer_voice">"encryptDES3"</span> or <span class="cv_-_computer_voice">"encryptRSA128"</span>. Any legacy encryption plugins (if you did not originally enter a name) have the name <span class="cv_-_computer_voice">"IEncryption"</span>.</div>
      <div class="B_-_Body"><a name="2388947">During server startup, the upgrader checks the encryption ID of data in the main database. The server compares this encryption ID with the encryption ID associated with the current encryption plugin. If the encryption IDs are different, the upgrader decrypts encrypted fields with the old encryption plugin, found by its encryption ID. Next, the server encrypts the fields to be encrypted with the new encryption plugin, found by its plugin name as specified by the parameter </a><span class="cv_-_computer_voice">CurrentEncryptionPlugin</span>.</div>
      <div class="B_-_Body"><a name="2388948">The most important things to remember whenever you change encryption algorithms are:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2390210">All encryption plugins must return their appropriate encryption IDs correctly.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2390226">All encryption plugins must implement </a><span class="cv_-_computer_voice">getEncryptedLength</span> correctly.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2390234">You must set </a><span class="cv_-_computer_voice">CurrentEncryptionPlugin</span> to the correct plugin name.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2388951">The server uses an internal lookup table to map all previously used encryption IDs to an incrementing integer value. This value is stored with database data. Internally, the upgrader manages this lookup table to determine whether data needs to be upgraded to the latest encryption algorithm. Do not attempt to manage this table directly. Instead, assure every encryption plugin returns its appropriate encryption ID, and assure </a><span class="cv_-_computer_voice">CurrentEncryptionPlugin</span> specifies the correct plugin name.</div>
      <div class="B_-_Body"><a name="2390461">Be careful not to confuse the encryption ID of a plugin implementation with its plugin name or class name. The server relies on the encryption ID saved with the database and the encryption ID of the current encryption plugin to identify whether the encryption algorithm changed. </a></div>
      <div class="B_-_Body"><a name="2428166">For claim snapshots, the encryption ID used to encrypt the snapshot is saved in the claim snapshot with each encrypted field. The upgrader does not upgrade claim snapshots or archive databases during the normal upgrade process. </a></div>
      <h6 class="HS_-_Head_Sub"><a name="2428167">See also</a></h6>
      <div class="B_-_Body"><a href="javascript:WWHClickedPopup('integration', 'encryption.21.4.html#2428209', '');" title="Encryption Changes with Snapshots" name="2428171">“Encryption Changes with Snapshots”</a></div>
      <h4 class="H2_-_Heading_2"><a name="2418196">Changing Your Encryption Algorithm</a></h4>
      <div class="B_-_Body"><a name="2418197">The following procedure describes how to change your encryption algorithm. It is extremely important to follow it exactly and very carefully. If you have questions about this before doing it, contact Guidewire Professional Services before proceeding.</a></div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="2389030">Do not follow this procedure until you are sure you understand it and test your encryption algorithm code. Before proceeding, be confident of your encryption code, particularly your implementation of the plugin method </a><span class="cv_-_computer_voice">getEncryptedLength</span>. Failure to perform this procedure correctly risks data corruption.</div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><a name="2389041">Shut down your server. </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2389053">Register a new plugin implementation of the </a><span class="cv_-_computer_voice">IEncryption</span> plugin for your new algorithm. When you add an implementation of the plugin in Studio, it prompts you for a plugin&nbsp;name for your new implementation. Name it appropriately to match the algorithm. For example, <span class="cv_-_computer_voice">"encryptDES3"</span>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2389057">Be sure your plugin returns an appropriate and unique encryption ID. Name it appropriately to match the algorithm. For example, </a><span class="cv_-_computer_voice">"encryptDES3"</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2388154">Set the </a><span class="cv_-_computer_voice">config.xml</span> configuration parameter <span class="cv_-_computer_voice">CurrentEncryptionPlugin</span> to the plugin&nbsp;name of your new encryption plugin. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2428176">Continue to register your older encryption plugins so that ClaimCenter can decrypt any encrypted data in claim snapshots in archived claims. </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	6.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2416266">Start the server. The upgrader uses the old encryption plugin to decrypt your data and then encrypts it with the new algorithm.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <h6 class="HS_-_Head_Sub"><a name="2424918">See also</a></h6>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a href="javascript:WWHClickedPopup('integration', 'encryption.21.2.html#2359408', '');" title="Encryption Integration Overview" name="2424984">“Writing Your Encryption Plugin”</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a href="javascript:WWHClickedPopup('integration', 'encryption.21.4.html#2428209', '');" title="Encryption Changes with Snapshots" name="2428184">“Encryption Changes with Snapshots”</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="2424969">Critical Warning: If You Change Encryption Algorithms, You May Still Need the Old Algorithm</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2424970">If you change your encryption algorithm, it is important to realize that you may need to continue to register your encryption plugin implementations for your older algorithm.</a></div>
      <div class="B_-_Body"><a name="2428189">For claim snapshots, changes to encryption do not occur immediately in the main database as part of the normal upgrader. There is a work queue that converts snapshots over time. See </a><a href="javascript:WWHClickedPopup('integration', 'encryption.21.4.html#2428209', '');" title="Encryption Changes with Snapshots">“Encryption Changes with Snapshots”</a>. Even after running the upgrader, you must continue to register your encryption plugins for your old encryption algorithms. The snapshot includes the encryption ID for the plugin that encrypted the snapshot. To restore the claim, the work queue needs that encryption plugin to decrypt the snapshot. Next, ClaimCenter uses the current encryption algorithm to encrypt again.</div>
      <div class="B_-_Body"><a name="2424152">For archived claims, changes to encryption do not occur immediately in the main database as part of the normal upgrader. Even after running the upgrader, you must continue to register encryption plugin implementations for your old encryption algorithms. The archive data includes the encryption ID for the plugin that originally encrypted the data. When ClaimCenter restores that claim, the application needs the encryption plugin for older algorithms to decrypt encrypted properties. Next, ClaimCenter uses the current encryption algorithm to encrypt any encrypted properties.</a></div>
      <div class="B_-_Body"><a name="2428197">Archived claim snapshots in archive databases with outdated encryption remain in their non-upgrade state until the claim is restored. </a></div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="2428203">Register one encryption plugin implementation for every encryption algorithm that might be referenced by encryption ID in any claim snapshots or archived data.</a> Ensure that all encryption plugin implementations return the correct encryption ID.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>