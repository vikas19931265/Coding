<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Approval Routing Rule Set Category</title>
    <link rel="StyleSheet" href="css/cc_rulesets.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>ClaimCenter Rules Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="p-rules.html#16623982">Gosu Business Rules</a> : <a class="WebWorks_Breadcrumb_Link" href="cc_rulesets.09.01.html#16623982">Rule Set Categories</a> : Approval Routing Rule Set Category</span></div>
    <hr align="left" />
    <blockquote>
      <h3 class="H1_-_Heading_1"><a name="16623982">Approval Routing Rule Set Category</a></h3>
      <div class="B_-_Body"><a name="16506323">Approval routing rules route an approval activity for a transaction that requires approval. ClaimCenter uses approval routing rules to determine which person to assign the approval activity to. Typically, a supervisor is the approving authority. The transaction set and its transactions remain in a </a><span class="e_-_emphasis">pending approval</span> state until someone approves the activity.</div>
      <h4 class="H2_-_Heading_2"><a name="16506326">Approval Routing Rules</a></h4>
      <div class="B_-_Body"><a name="16506330">The Approval Routing rule set and the rule sets in the Transaction Approval rule set category form a pair. ClaimCenter calls these rule sets sequentially. </a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="16506334">ClaimCenter calls rule sets in the Transaction Approval rule set category any time that you submit any kind of financial transaction. See </a><a href="javascript:WWHClickedPopup('rules', 'cc_rulesets.09.17.html#16507608', '');" title="Transaction Approval Rule Set Category">“Transaction Approval Rule Set Category”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="16506335">ClaimCenter calls the Approval Routing rule set either if the outcome of transaction approval is Yes or if the transaction authority limit is exceeded, causing the transaction to need approval. See </a><a href="javascript:WWHClickedPopup('rules', 'cc_rulesets.09.03.html#16506326', '');" title="Approval Routing Rule Set Category">“Approval Routing Rules”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="16506336">Be careful not to create approval rules that generate an infinite loop. For example, suppose a rule first assigns the transaction to a supervisor for approval, who subsequently approves it. Then, the rule assigns the transaction approval to someone who does not have the authority to approve the transaction. ClaimCenter runs the rule set again, and again reassigns the approval to the supervisor, generating a never-ending loop.</a></div>
      <div class="B_-_Body"><a name="16506337">The following list describes the main methods used to set the person who can approve the activity. These methods are available on the </a><span class="cv_-_computer_voice">TransactionSet</span> object. </div>
      <div class="T_-_Table"><a name="16506366">&nbsp;</a></div>
      <table class="Shading" style="text-align: left" border="0" cellpadding="10" cellspacing="0" summary="">
        <caption></caption>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: bottom">
            <div class="TH_-_Table_Heading"><a name="16506340">Method	</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: bottom">
            <div class="TH_-_Table_Heading"><a name="16506342">Description</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #c0d1d1; border-bottom-style: solid; border-bottom-width: 0.15pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text" style="color: #000000; font-family: &quot;Lucida Sans Typewriter&quot;; font-style: normal; font-variant: normal; font-weight: normal; margin-top: 3.0pt; text-transform: none; vertical-align: baseline"><span class="cvt_-_computer_voice_table"><a name="16506345">approveByGroupSupervisor</a></span></div>
          </td>
          <td style="border-bottom-color: #c0d1d1; border-bottom-style: solid; border-bottom-width: 0.15pt; border-top-color: #000000; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text"><a name="16506347">Use to assign an approval active to a group supervisor based on the exposure or exposures associated with the transaction:</a></div>
            <div class="BIT_-_Bullet_Item_Table_outer" style="margin-left: 2.16pt">
              <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
                <tr style="vertical-align: baseline">
                  <td>
                    <div class="BIT_-_Bullet_Item_Table_inner" style="width: 7.199999999999999pt; white-space: nowrap">
                      <span class="but_-_bullet_in_table">•	</span>
                    </div>
                  </td>
                  <td width="100%">
                    <div class="BIT_-_Bullet_Item_Table_inner"><a name="16506348">If the transaction set has transactions associated with </a><span class="e_-_emphasis">only one</span> exposure—the method assigns the approval activity to the supervisor of the group assigned to the exposure.</div>
                  </td>
                </tr>
              </table>
            </div>
            <div class="BIT_-_Bullet_Item_Table_outer" style="margin-left: 2.16pt">
              <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
                <tr style="vertical-align: baseline">
                  <td>
                    <div class="BIT_-_Bullet_Item_Table_inner" style="width: 7.199999999999999pt; white-space: nowrap">
                      <span class="but_-_bullet_in_table">•	</span>
                    </div>
                  </td>
                  <td width="100%">
                    <div class="BIT_-_Bullet_Item_Table_inner"><a name="16506349">If the transaction set has transactions associated with </a><span class="e_-_emphasis">more than one</span> exposure—the method assigns the approval activity to the supervisor of the group assigned to the associated claim.</div>
                  </td>
                </tr>
              </table>
            </div>
            <div class="TT_-_Table_Text"><a name="16506350">In either case, if the supervisor of the group is the same as the user requesting approval, then the activity remains unassigned. </a><span class="e_-_emphasis">If you use this method, you must explicitly handle this case.</span></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #c0d1d1; border-bottom-style: solid; border-bottom-width: 0.15pt; border-top-color: #c0d1d1; border-top-style: solid; border-top-width: 0.15pt; padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text" style="color: #000000; font-family: &quot;Lucida Sans Typewriter&quot;; font-style: normal; font-variant: normal; font-weight: normal; margin-top: 3.0pt; text-transform: none; vertical-align: baseline"><span class="cvt_-_computer_voice_table"><a name="16506353">approveByUserSupervisor</a></span></div>
          </td>
          <td style="border-bottom-color: #c0d1d1; border-bottom-style: solid; border-bottom-width: 0.15pt; border-top-color: #c0d1d1; border-top-style: solid; border-top-width: 0.15pt; padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text"><a name="16506355">Use to assign an approval activity to a group supervisor based on the user who submitted the transaction:</a></div>
            <div class="BIT_-_Bullet_Item_Table_outer" style="margin-left: 2.16pt">
              <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
                <tr style="vertical-align: baseline">
                  <td>
                    <div class="BIT_-_Bullet_Item_Table_inner" style="width: 7.199999999999999pt; white-space: nowrap">
                      <span class="but_-_bullet_in_table">•	</span>
                    </div>
                  </td>
                  <td width="100%">
                    <div class="BIT_-_Bullet_Item_Table_inner"><a name="16506356">If the submitting user is in the owning group and is not the supervisor, then approval goes to the group supervisor. </a></div>
                  </td>
                </tr>
              </table>
            </div>
            <div class="BIT_-_Bullet_Item_Table_outer" style="margin-left: 2.16pt">
              <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
                <tr style="vertical-align: baseline">
                  <td>
                    <div class="BIT_-_Bullet_Item_Table_inner" style="width: 7.199999999999999pt; white-space: nowrap">
                      <span class="but_-_bullet_in_table">•	</span>
                    </div>
                  </td>
                  <td width="100%">
                    <div class="BIT_-_Bullet_Item_Table_inner"><a name="16506357">If the submitting user is the group supervisor, then ClaimCenter escalates the approval to the group supervisor of the next group up the group hierarchy. </a></div>
                  </td>
                </tr>
              </table>
            </div>
            <div class="BIT_-_Bullet_Item_Table_outer" style="margin-left: 2.16pt">
              <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
                <tr style="vertical-align: baseline">
                  <td>
                    <div class="BIT_-_Bullet_Item_Table_inner" style="width: 7.199999999999999pt; white-space: nowrap">
                      <span class="but_-_bullet_in_table">•	</span>
                    </div>
                  </td>
                  <td width="100%">
                    <div class="BIT_-_Bullet_Item_Table_inner"><a name="16506358">If the submitting user is a group supervisor someplace higher in the hierarchy, then the approval escalates to the supervisor of the next group up the hierarchy.</a></div>
                  </td>
                </tr>
              </table>
            </div>
            <div class="BIT_-_Bullet_Item_Table_outer" style="margin-left: 2.16pt">
              <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
                <tr style="vertical-align: baseline">
                  <td>
                    <div class="BIT_-_Bullet_Item_Table_inner" style="width: 7.199999999999999pt; white-space: nowrap">
                      <span class="but_-_bullet_in_table">•	</span>
                    </div>
                  </td>
                  <td width="100%">
                    <div class="BIT_-_Bullet_Item_Table_inner"><a name="16506360">If the submitting user is in </a><span class="e_-_emphasis">one and only one</span> group, then the approval goes to the supervisor of that group. Otherwise, approval goes to the supervisor of the owning group.</div>
                  </td>
                </tr>
              </table>
            </div>
            <div class="TT_-_Table_Text"><a name="16624689">Finally, if ClaimCenter worked its way through the previous conditions to the supervisor of the root group without making an assignment, then ClaimCenter assigns the approval to user </a><span class="e_-_emphasis">defaultowner</span>. </div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-top-color: #c0d1d1; border-top-style: solid; border-top-width: 0.15pt; padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text" style="color: #000000; font-family: &quot;Lucida Sans Typewriter&quot;; font-style: normal; font-variant: normal; font-weight: normal; margin-top: 3.0pt; text-transform: none; vertical-align: baseline"><span class="cvt_-_computer_voice_table"><a name="16506363">setApprovingUser</a></span></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 0.5pt; border-top-color: #c0d1d1; border-top-style: solid; border-top-width: 0.15pt; padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text"><a name="16771382">Use to assign an approval activity to a specified user. You must provide a user and group as parameters. The method checks whether the user is retired or inactive (</a><span class="cvt_-_computer_voice_table">user.credential.Active != true</span>) and returns <span class="cvt_-_computer_voice_table">false</span> if either of these conditions exist. It also returns <span class="cvt_-_computer_voice_table">false</span> if the user or group is missing. It returns <span class="cvt_-_computer_voice_table">true</span> otherwise. </div>
            <div class="TT_-_Table_Text"><span class="s_-_strong"><a name="16771222">IMPORTANT</a></span> Only call this method from within the Approval Routing rule set.</div>
          </td>
        </tr>
      </table>
      <div class="B_-_Body"><a name="16506367">In the following example, the rule assigns the approval to the supervisor, unless the supervisor is the one who entered the transaction.</a></div>
      <h6 class="HS_-_Head_Sub"><a name="16506368">Condition</a></h6>
      <div class="CS_-_Code_Single_Line"><a name="16506369">return true</a></div>
      <h6 class="HS_-_Head_Sub"><a name="16506370">Action</a></h6>
      <PRE class="CF_-_Code_First_Line"><a name="16852191">var exp = transactionSet.AllTransactions*.Exposure</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="16852192">// Verify that the supervisor has not already approved this TransactionSet</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="16852193"> </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="16852194">if (not exists( act in transactionSet.Claim.Activities where (act.TransactionSet == transactionSet</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="16852195">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and (act.ActivityPattern.Code == "approve_reserve_change" </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="16852196">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or act.ActivityPattern.Code == "approve_payment" ) </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="16852197">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and act.Approved == true and act.AssignedUser == exp[0].AssignedGroup.Supervisor ))) {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="16852198">&nbsp;&nbsp;if ( transactionSet.approveByGroupSupervisor() ) { </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="16852199">&nbsp;&nbsp;&nbsp;&nbsp;gw.api.util.Logger.logDebug( " Assign to supervisor" )</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="16852200">&nbsp;&nbsp;&nbsp;&nbsp;gw.api.util.Logger.logDebug( transactionSet.AllTransactions*.Exposure[0].AssignedGroup.Supervisor.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="16852273">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Contact.DisplayName )</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="16852202">&nbsp;&nbsp;&nbsp;&nbsp;actions.exit()</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="16852203">&nbsp;&nbsp;}</a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="16506385">}</a></PRE>
      <h4 class="H2_-_Heading_2"><a name="16506387">BulkInvoice Approval Assignment Rules</a></h4>
      <div class="BKN_-_Body_002c_Keep_Next"><a name="16996925">The BulkInvoice Approval Assignment Rules and the BulkInvoice Approval Rules rule sets form a pair. These rules work together similarly to the rule sets in the Approval Routing rule set category and the Transaction Approval rule set category. ClaimCenter calls these rule sets sequentially. </a></div>
      <div class="B_-_Body"><a name="16996918">ClaimCenter runs the BulkInvoice Approval Assignment rule set for each bulk invoice to determine to whom to assign it for approval. See </a><a href="javascript:WWHClickedPopup('rules', 'cc_rulesets.09.06.html#16506548', '');" title="BulkInvoice Approval Rule Set Category">“BulkInvoice Approval Rules”</a>.</div>
      <div class="B_-_Body"><a name="16506401">In the following example, the rule assigns approval for bulk invoice payments to user Carla Levitt in the Headquarters group.</a></div>
      <h6 class="HS_-_Head_Sub"><a name="16506402">Condition</a></h6>
      <div class="CS_-_Code_Single_Line"><a name="16506403">return true</a></div>
      <h6 class="HS_-_Head_Sub"><a name="16506404">Action</a></h6>
      <PRE class="CF_-_Code_First_Line"><a name="16506405">bulkInvoice.setApprovingUser(User( "demo_sample:39" /* Carla Levitt */ ),</a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="17006948">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;util.RuleGroups.instance.getHeadquarters())</a></PRE>
      <h6 class="HS_-_Head_Sub"><a name="17006960">See also</a></h6>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a href="javascript:WWHClickedPopup('rules', 'cc_rulesets.09.03.html#16623982', '');" title="Approval Routing Rule Set Category" name="17006983">Approval Routing Rule Set Category</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a href="javascript:WWHClickedPopup('rules', 'cc_rulesets.09.17.html#16507608', '');" title="Transaction Approval Rule Set Category" name="17007004">Transaction Approval Rule Set Category</a></div>
            </td>
          </tr>
        </table>
      </div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>