<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Using Comparison Predicates with Date and Time Fields</title>
    <link rel="StyleSheet" href="css/querybuilder.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>Gosu Reference Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="querybuilder.10.01.html#3233908">Query Builder APIs</a> : <a class="WebWorks_Breadcrumb_Link" href="querybuilder.10.12.html#3233908">Restricting Queries with Predicates on Fields</a> : Using Comparison Predicates with Date and Time Fields</span></div>
    <hr align="left" />
    <blockquote>
      <h4 class="H2B_-_Heading_2_Break"><a name="3233908">Using Comparison Predicates with Date and Time Fields</a></h4>
      <div class="B_-_Body"><a name="3233909">Different brands of database have different functions that work with timestamp columns in SQL query statements. In contrast, the query builder APIs offer these database functions for working with timestamp columns:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="cv_-_computer_voice"><a name="2560672">DateDiff</a></span> – See <a href="javascript:WWHClickedPopup('gosu', 'querybuilder.10.14.html#2238279', '');" title="Using Comparison Predicates with Date and Time Fields">Comparing the Interval Between Two Date and Time Fields</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="cv_-_computer_voice"><a name="2560691">DatePart</a></span> – See <a href="javascript:WWHClickedPopup('gosu', 'querybuilder.10.14.html#2551578', '');" title="Using Comparison Predicates with Date and Time Fields">Comparing Parts of a Date and Time Field</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="cv_-_computer_voice"><a name="2632158">DateFromTimestamp</a></span> – See <a href="javascript:WWHClickedPopup('gosu', 'querybuilder.10.14.html#2568531', '');" title="Using Comparison Predicates with Date and Time Fields">Comparing the Date Part of a Date and Time Field</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="2238279">Comparing the Interval Between Two Date and Time Fields</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2238281">Use the static </a><span class="cv_-_computer_voice">DateDiff</span> method of the <span class="cv_-_computer_voice">DBFunction</span> class to compute the interval between two <span class="cv_-_computer_voice">DateTime</span> fields. The <span class="cv_-_computer_voice">DateDiff</span> method takes two <span class="cv_-_computer_voice">ColumnRef</span> parameters to timestamp fields in the database: a starting timestamp and an ending timestamp. It returns the interval between the two.</div>
      <div class="CS_-_Code_Single_Line"><a name="2523326">DateDiff(dateDiffPart : DateDiffPart, startDate : ColumnRef, endDate : ColumnRef) : DBFunction</a></div>
      <div class="B_-_Body"><a name="2523319">The method has an initial parameter, </a><span class="cv_-_computer_voice">dateDiffPart</span>, that lets you specify the unit of measure for the result. You can specify <span class="cv_-_computer_voice">DAYS</span>, <span class="cv_-_computer_voice">HOURS</span>, <span class="cv_-_computer_voice">SECONDS</span>, or <span class="cv_-_computer_voice">MILLISECONDS</span>. If <span class="cv_-_computer_voice">endDate</span> precedes the <span class="cv_-_computer_voice">startDate</span>, the method returns a negative value for the interval, instead of a positive value. </div>
      <h6 class="HS_-_Head_Sub"><a name="2238283">Example of the </a><span class="cvh_-_computer_voice_in_heading">DateDiff</span> Method</h6>
      <div class="B_-_Body"><a name="2523159">The following sample Gosu code uses the </a><span class="cv_-_computer_voice">DateDiff</span> method to compute the interval between the assigned date and the due date on an activity. The query builder code uses the returned interval in a comparison predicate to select activities with due dates less than 15 days from their assignment dates. </div>
      <PRE class="CF_-_Code_First_Line"><a name="2523962">uses gw.api.database.Query</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2523813">uses gw.api.database.DBFunction</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2523814">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2523905">var query = Query.make(Activity) </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2523815">// Query for activities with due dates less than 15 days from the assigned date.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2523849">query.</a><span class="s_-_strong">compare</span>(DBFunction.<span class="s_-_strong">DateDiff</span>(DAYS, query.getColumnRef(<span class="s_-_strong">"AssignmentDate"</span>),</PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2523854">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query.getColumnRef(</a><span class="s_-_strong">"EndDate"</span>)), <span class="s_-_strong">LessThan</span>, <span class="s_-_strong">15</span>)</PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2523850">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2523819">// Order the result by assignment date.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2523944">for (activity in (query.select().orderBy(\ row -&gt; row.AssignmentDate))) { </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2523820">  print("Assigned on " + activity.AssignmentDate + ": " + activity.DisplayName) </a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="2523821">}</a></PRE>
      <h6 class="HS_-_Head_Sub"><span class="cvh_-_computer_voice_in_heading"><a name="2522496">DateDiff</a></span> Method Daylight Saving or Summer Time </h6>
      <div class="B_-_Body"><a name="2522995">The </a><span class="cv_-_computer_voice">DateDiff</span> method does not adjust for daylight saving, or summer, time. For example, daylight saving or summer time in your locale ends on the first Sunday in November. The <span class="cv_-_computer_voice">DateDiff</span> method operates on a row with the <span class="cv_-_computer_voice">DateTime</span> values <span class="cv_-_computer_voice">2011-11-5 12:00</span> and <span class="cv_-_computer_voice">2011-11-6 12:00</span>. The method returns an interval of 24 hours, even though 25 hours separate the two in solar time.</div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="2551578">Comparing Parts of a Date and Time Field</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2555370">Use the static </a><span class="cv_-_computer_voice">DatePart</span> method of the <span class="cv_-_computer_voice">DBFunction</span> class to extract a portion of a <span class="cv_-_computer_voice">DateTime</span> field to use in a comparison predicate. The <span class="cv_-_computer_voice">DatePart</span> method takes two parameters. The first parameter specifies the part of the date and time you want to extract, and the second parameter specifies the field from which to extract the part. It returns the extracted part as a <span class="cv_-_computer_voice">Number</span>. </div>
      <div class="CS_-_Code_Single_Line"><a name="2555371">DateDiff(datePart : DatePart, date : ColumnRef) : DBFunction</a></div>
      <div class="B_-_Body"><a name="2555372">For the </a><span class="cv_-_computer_voice">datePart</span> parameter, you can specify <span class="cv_-_computer_voice">HOUR</span>, <span class="cv_-_computer_voice">MINUTE</span>, <span class="cv_-_computer_voice">SECOND</span>, <span class="cv_-_computer_voice">DAY_OF_WEEK</span>, <span class="cv_-_computer_voice">DAY_OF_MONTH</span>, <span class="cv_-_computer_voice">MONTH</span>, or <span class="cv_-_computer_voice">YEAR</span>. </div>
      <div class="B_-_Body"><a name="2555981">The following sample Gosu codes uses the </a><span class="cv_-_computer_voice">DatePart</span> method to extract the day of the month from the due date on activities. The query builder codes uses the returned numeric value in a comparison predicate to select activities that are due on the 15th of any month. </div>
      <PRE class="CF_-_Code_First_Line"><a name="2556366">uses gw.api.database.Query</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2556367">uses gw.api.database.DBFunction</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2556368">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2556369">var query = Query.make(Activity) </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2556370">// Query for activities with due dates that fall on the 15th of any month.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2556371">query.</a><span class="s_-_strong">compare</span>(DBFunction.<span class="s_-_strong">DatePart</span>(DAY_OF_MONTH, query.getColumnRef(<span class="s_-_strong">"endDate"</span>)), <span class="s_-_strong">Equals</span>, <span class="s_-_strong">15</span>)</PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2560762">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2560768">// Order the result by assignment date and iterate the items fetched. </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2560763">for (activity in (query.select().orderBy(\ row -&gt; row.AssignmentDate))) {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2560764">  print("Assigned on " + activity.AssignmentDate + ": " + activity.DisplayName) </a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="2556375">}</a></PRE>
      <div class="B_-_Body"><a name="2560824">When you specify </a><span class="cv_-_computer_voice">DAY_OF_WEEK</span> as the part to extract, the first day of the week is Monday. </div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="2568531">Comparing the Date Part of a Date and Time Field</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2631219">Use the static </a><span class="cv_-_computer_voice">DateFromTimestamp</span> method of the <span class="cv_-_computer_voice">DBFunction</span> class to extract the date portion of a <span class="cv_-_computer_voice">DateTime</span> field to use in a comparison predicate. The <span class="cv_-_computer_voice">DateFromTimestamp</span> method takes a single parameter, a column reference to a <span class="cv_-_computer_voice">DateTime</span> field. It returns a <span class="cv_-_computer_voice">java.util.Date</span> with only the date portion specified.</div>
      <div class="CS_-_Code_Single_Line" style="font-style: normal; font-variant: normal; font-weight: normal; text-transform: none; vertical-align: baseline"><span class="cv_-_computer_voice"><a name="2631638">DateFromTimestamp(timestamp : ColumnRef) : DBfunction</a></span></div>
      <div class="B_-_Body"><a name="2631700">The following sample Gosu code uses the </a><span class="cv_-_computer_voice">DateFromTimestamp</span> method to extract the date from the create timestamp on activities. The query builder code uses the returned date in a comparison predicate to select activities that were created some time during the current day. </div>
      <PRE class="CF_-_Code_First_Line"><a name="2632057">uses gw.api.database.Query</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2632058">uses gw.api.database.DBFunction</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2632059">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2632198">// Make a query of Address instances.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2632199">var query = Query.make(Address) </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2632200">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2632201">// Query for addresses created today.  </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2632202">query.compare(DBFunction.</a><span class="s_-_strong">DateFromTimestamp</span>(query.getColumnRef("<span class="s_-_strong">CreateTime</span>")), Equals, DateTime.<span class="s_-_strong">Today</span>)</PRE>
      <PRE class="CM_-_Code_Middle_Line" style="font-style: normal; font-variant: normal; font-weight: bold; text-transform: none; vertical-align: baseline"><span class="s_-_strong"><a name="2634922">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></span></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2632208">// Order the result by creation date and iterate the items fetched.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2632209">for (address in query.select().orderBy(\ row -&gt; row.CreateTime)) {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2634938">&nbsp;&nbsp;print(address.DisplayName + ": " + address.CreateTime)</a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="2632224">}</a></PRE>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>