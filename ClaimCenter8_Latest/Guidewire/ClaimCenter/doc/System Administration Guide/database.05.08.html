<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Understanding and Authorizing Database Upgrades</title>
    <link rel="StyleSheet" href="css/database.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>ClaimCenter System Administration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="database.05.01.html#1259080">Configuring and Maintaining the ClaimCenter Database</a> : Understanding and Authorizing Database Upgrades</span></div>
    <hr align="left" />
    <blockquote>
      <h3 class="H1_-_Heading_1"><a name="1259080">Understanding and Authorizing Database Upgrades</a></h3>
      <div class="B_-_Body"><a name="1259073">When you start ClaimCenter, it compares system metadata (the description of the objects and tables in the </a><span class="cv_-_computer_voice">config</span> directory) to the database to see if they match. For example, if a new extension has been added since the last server start, the database and metadata do not match. If these two do not match, ClaimCenter attempts to upgrade the database to match the metadata. </div>
      <div class="B_-_Body"><a name="1039076">If the </a><span class="cv_-_computer_voice">autoupgrade</span> attribute of the <span class="cv_-_computer_voice">database</span> connection settings block in <span class="cv_-_computer_voice">database-config.xml</span> is set to <span class="cv_-_computer_voice">true</span>, then, at startup, ClaimCenter makes database changes without waiting for confirmation. If <span class="cv_-_computer_voice">autoupgrade</span> is <span class="cv_-_computer_voice">false</span>, ClaimCenter reports the need to upgrade the database to the console and sets the run level to <span class="cv_-_computer_voice">shutdown</span>.</div>
      <div class="B_-_Body"><a name="1217447">Disable automatic upgrades in production environments to prevent unexpected changes. To disable automatic upgrades, set </a><span class="cv_-_computer_voice">autoupgrade</span> to <span class="cv_-_computer_voice">false</span>. During configuration and testing, it is more convenient to have database changes execute automatically. In this case, set <span class="cv_-_computer_voice">autoupgrade</span> to <span class="cv_-_computer_voice">true</span>. In either case, the first time you start ClaimCenter, it must perform a database upgrade.</div>
      <div class="B_-_Body"><a name="1238103">You can trigger a database upgrade without a change in the metadata by incrementing the version number in </a><span class="cv_-_computer_voice">config/extensions/extensions.properties</span>.</div>
      <div class="B_-_Body"><a name="1039085">The upgrade process calculates current checksums for all the XML files in the data model. It then compares them with historical checksums stored in the </a><span class="cv_-_computer_voice">SystemParameter</span> entity. If the values differ, then ClaimCenter upgrades the database to match the metadata. As the last step in the upgrade, ClaimCenter upgrades the <span class="cv_-_computer_voice">SystemParameter</span> entity with the current checksums.</div>
      <div class="B_-_Body"><a name="1039087">If during the upgrade ClaimCenter creates a new table, then it also generates a unique index for the table. The </a><span class="cv_-_computer_voice">TableRegistry</span> entity stores this information. In this way, ClaimCenter guarantees uniqueness.</div>
      <div class="B_-_Body"><a name="1217115">Before completing, ClaimCenter again verifies the data model against the physical database. You can run the schema verifier from the command line with the following command:</a></div>
      <div class="CS_-_Code_Single_Line"><a name="1217117">system_tools -password </a><span class="pc_-_parameter_in_code">password</span> -verifydbschema</div>
      <div class="B_-_Body"><a name="1217118">If, for some reason, the model and database disagree, ClaimCenter writes warnings to the log and, if possible, suggests corrective actions. Take the corrective action if prompted to do so. </a></div>
      <div class="B_-_Body"><a name="1039100">The database upgrade takes a number of actions that can impact database statistics. The upgrade might recreate tables, drop indexes and create new indexes. The </a><span class="cv_-_computer_voice">autoupgrade</span> process writes an <span class="cv_-_computer_voice">updatedatabasestatistics.sql</span> file to the <span class="cv_-_computer_voice">work</span> directory on the application server. The contents of the file are dependent on the SQL executed during the upgrade and the settings of the <span class="cv_-_computer_voice">&lt;database&gt;</span> element’s statistic parameters. Run this script after an automatic upgrade to update database statistics. See <a href="javascript:WWHClickedPopup('admin', 'database.05.10.html#1199461', '');" title="Configuring Database Statistics">“Configuring Database Statistics”</a> for more information about setting the statistics parameters.</div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="1039105">If the server is interrupted during a database upgrade for any reason, the server resumes the upgrade upon restart. The ClaimCenter accomplishes this by storing the steps in the database and marking them completed as part of the same database transaction that applies a change.</a></div>
      <div class="B_-_Body"><a name="1057565">For more details on configuration changes that require database upgrades, see </a><a href="javascript:WWHClickedPopup('config', 'extenddm.20.01.html#1068029', '');" title="Modifying the Base Data Model">“Modifying the Base Data Model” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'extenddm.20.01.html#1068029', '');" title="Modifying the Base Data Model">Configuration Guide</a></span>.</div>
      <div class="B_-_Body"><a name="1287708">ClaimCenter includes an </a><span class="ui_-_UI_element">Upgrade Info</span> page that provides detailed information about the database upgrade. The <span class="ui_-_UI_element">Upgrade Info</span> page includes information on the following:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1287709">version numbers before and after the database upgrade</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1287710">configuration parameters used during the database upgrade</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1287711">SQL queries for version checks that test if the database is in condition to be upgraded</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1287712">changes made to specific tables, including which version triggers modified the table or its data and the SQL statement executed to make each change</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1287713">version triggers that the upgrade ran, including which tables the trigger ran against, a description, the SQL statement run against each table and the start and end time</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1287714">a list of upgrade steps, including the table on which the step operated</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1287715">a table registry including table IDs before and after upgrade</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="1287716">The database upgrade deletes upgrade instrumentation information for prior database upgrades. If the database upgrade detects any prior upgrade instrumentation data, it reports a warning and deletes the data. If you have run previous database upgrades, and you want to preserve upgrade instrumentation details, download this information.</a></div>
      <h6 class="HS_-_Head_Sub"><a name="1287717">To download upgrade instrumentation details</a></h6>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><a name="1287721">Start the ClaimCenter server if it is not already running.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1287725">Log in to ClaimCenter with the superuser account.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1287726">Press </a><span class="cv_-_computer_voice">ALT</span>+<span class="cv_-_computer_voice">SHIFT</span>+<span class="cv_-_computer_voice">T</span> to access <span class="ui_-_UI_element">System Tools</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1287727">Click </a><span class="ui_-_UI_element">Info Pages</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1287728">Select </a><span class="ui_-_UI_element">Upgrade Info</span> from the <span class="ui_-_UI_element">Info Pages</span> drop-down.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	6.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1287729">Click </a><span class="ui_-_UI_element">Download</span> to download a ZIP file containing the detailed upgrade information.</div>
            </td>
          </tr>
        </table>
      </div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>