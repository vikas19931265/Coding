<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Archive Retrieval Integration Detailed Flow</title>
    <link rel="StyleSheet" href="css/archiving-integration.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>ClaimCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="p-claims.html#2038398">Other Integration Topics</a> : <a class="WebWorks_Breadcrumb_Link" href="archiving-integration.40.1.html#2038398">Archiving Integration</a> : Archive Retrieval Integration Detailed Flow</span></div>
    <hr align="left" />
    <blockquote>
      <h3 class="H1_-_Heading_1"><a name="2038398">Archive Retrieval Integration Detailed Flow</a></h3>
      <div class="B_-_Body"><a name="2127200">As one part of the retrieve process, </a><span class="e_-_emphasis">retrieval</span> is the step of getting data from an archive source back into the main database. It is up to you provide the necessary hooks into the retrieve process. </div>
      <div class="B_-_Body"><a name="2127196">For example, in ClaimCenter, with archiving enabled, the </a><span class="ui_-_UI_element">Advanced Search</span> screen displays a <span class="ui_-_UI_element">Retrieve from Archive</span> button if the search query returns an archived item.</div>
      <div class="B_-_Body"><a name="2127190">Within ClaimCenter, archive document retrieval has the following overall flow:</a></div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><a name="2127191">The user identifies an object to retrieve.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2133895">Synchronously, the retrieve request work queue finds items to retrieve</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2127178">ClaimCenter calls the </a><span class="cv_-_computer_voice">IArchiveSoure</span> plugin method called <span class="cv_-_computer_voice">retrieve</span>. ClaimCenter passes this method a reference to a <span class="cv_-_computer_voice">RootInfo</span> object. Your plugin implementation is responsible for returning the object binary data that describes the XML data that was originally stored. Your plugin implementation must provide this data as an <span class="cv_-_computer_voice">InputStream</span> object. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2127139">ClaimCenter clears the data on </a><span class="cv_-_computer_voice">ClaimInfo</span> that it copied from the <span class="cv_-_computer_voice">Claim</span> object during the initial archive process.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2127143">ClaimCenter creates any data that relates to the retrieve. For example, notes</a> and history events.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	6.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2127149">ClaimCenter performs any upgrade steps defined for the data. See </a><a href="javascript:WWHClickedPopup('integration', 'archiving-integration.40.6.html#2127102', '');" title="Upgrading the Data Model of Retrieved Data">“Upgrading the Data Model of Retrieved Data”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	7.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2094401">ClaimCenter calls </a><span class="cv_-_computer_voice">IArchiveSource.updateInfoOnRetrieve</span>. This method gives you a chance to perform additional operations in the same bundle as the retrieval operation, after ClaimCenter recreates all the entities but before the commit.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><span class="e_-_emphasis"><a name="2126872">In the demonstration plugin</a></span>, this method sets the <span class="cv_-_computer_voice">Claim.DateEligibleForArchive</span> property to a date based on the <span class="cv_-_computer_voice">DaysRetrievedBeforeArchive</span> configuration parameter. This ensures that the application does not immediately archive the object again but instead waits until it is eligible again.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	8.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2039084">ClaimCenter commits the bundle.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	9.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2127133">ClaimCenter calls </a><span class="cv_-_computer_voice">IArchiveSource.retrieveFinally</span>. It is up to you to decide what additional handling the retrieved data requires, if any. For example, you can use this method to perform final clean up on files in the archive source. Guidewire does <span class="s_-_strong">not</span> recommend, nor does it support, the use of this method to make changes to data after you retrieve it. Any attempt to commit these changes in the <span class="cv_-_computer_voice">retrieveFinally</span> method invokes the Preupdate and Validation rules. This is undesirable and unsupported. As ClaimCenter commits the main transaction for the retrieve process, it does not run these rules. Therefore, it is possible, for example, to retrieve objects that do not pass validation rules. Committing additional changes in <span class="cv_-_computer_voice">retrieveFinally</span> could fail validation, causing only those changes to be rolled back, not the entire retrieve request.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="2127127">Do not changes to the retrieved data in </a><span class="cv_-_computer_voice">retrieveFinally</span>.</div>
      <div class="B_-_Body"><a name="2039087">Before you delete the returned XML document, first consider whether it is important to compare what the archived item looked like initially with a subsequent archive of the same item.</a></div>
      <div class="B_-_Body"><a name="2039088">If the retrieval process does not complete successfully, then consult the application logs as well as the </a><span class="ui_-_UI_element">Server Tools → Archive Info</span> page. If you cannot view the <span class="ui_-_UI_element">Archive Info</span> page, you must set the configuration parameter <span class="cv_-_computer_voice">ArchiveEnabled</span> to <span class="cv_-_computer_voice">true</span> in <span class="cv_-_computer_voice">config.xml</span>.</div>
      <h6 class="HS_-_Head_Sub"><a name="2039089">See also</a></h6>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a href="javascript:WWHClickedPopup('config', 'archiving.54.01.html#2382247', '');" title="Configuring Claim Archiving" name="2126889">“Configuring Claim Archiving” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'archiving.54.01.html#2382247', '');" title="Configuring Claim Archiving">Configuration Guide</a></span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a href="javascript:WWHClickedPopup('integration', 'webservices-claim.12.12.html#3438158', '');" title="Archiving and Restoring Claims from External Systems" name="2126893">“Archiving and Restoring Claims from External Systems”</a></div>
            </td>
          </tr>
        </table>
      </div>
      <h4 class="H2_-_Heading_2"><a name="2057627">Archive Source Plugin Retrieve Methods</a></h4>
      <div class="BKN_-_Body_002c_Keep_Next"><a name="2038399">ClaimCenter calls the following </a><span class="cv_-_computer_voice">IArchiveSource</span> methods during the archive retrieval lifecycle:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt; margin-bottom: 2.0pt; vertical-align: baseline">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; text-transform: none">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; text-transform: none"><span class="cv_-_computer_voice"><a href="javascript:WWHClickedPopup('integration', 'archiving-integration.40.4.html#2156832', '');" title="Archive Retrieval Integration Detailed Flow" name="2038403">retrieve(info : RootInfo) : InputStream</a></span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt; margin-bottom: 2.0pt; vertical-align: baseline">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; text-transform: none">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; text-transform: none"><span class="cv_-_computer_voice"><a href="javascript:WWHClickedPopup('integration', 'archiving-integration.40.4.html#2038416', '');" title="Archive Retrieval Integration Detailed Flow" name="2038407">updateInfoOnRetrieve(info : RootInfo)</a></span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt; margin-bottom: 2.0pt; vertical-align: baseline">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; text-transform: none">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; text-transform: none"><span class="cv_-_computer_voice"><a href="javascript:WWHClickedPopup('integration', 'archiving-integration.40.4.html#2127116', '');" title="Archive Retrieval Integration Detailed Flow" name="2156828">retrieveFinally(info : RootInfo, finalStatus : ArchiveFinalStatus, cause : List&lt;String&gt;)</a></span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2156829">For ClaimCenter, when you see the interface type </a><span class="cv_-_computer_voice">RootInfo</span> in documentation or code in Studio, this always refers to a <span class="cv_-_computer_voice">ClaimInfo</span> entity instance.</div>
      <h6 class="HS_-_Head_Sub"><a name="2156832">retrieve(info : RootInfo) : InputStream</a></h6>
      <div class="B_-_Body"><a name="2134219">The retrieve method is the main configuration point for retrieving XML data from the external archive source. You must return the data as an </a><span class="cv_-_computer_voice">InputStream</span>. The archive process passes the <span class="cv_-_computer_voice">RootInfo</span> object to the plugin method to assist your plugin implementation to identify the correct data in the external system.</div>
      <div class="B_-_Body"><a name="2134423">For archive retrieval to work correctly, the </a><span class="cv_-_computer_voice">RootInfo</span> object must store enough information to determine how to retrieve the XML document from the backing store.</div>
      <h6 class="HS_-_Head_Sub"><a name="2038416">updateInfoOnRetrieve(info : RootInfo)</a></h6>
      <div class="B_-_Body"><a name="2038417">The retrieval process calls this method within the retrieval transaction. This occurs after the archive process populates the bundle of the </a><span class="cv_-_computer_voice">RootInfo</span> object with the objects produced by parsing the XML returned by the earlier call to <span class="cv_-_computer_voice">retrieve(RootInfo)</span>.</div>
      <div class="B_-_Body"><a name="2134551">From within the </a><span class="cv_-_computer_voice">updateInfoOnRetrieve</span> method, you can modify the new objects in the object graph as well as the <span class="cv_-_computer_voice">RootInfo</span> object.</div>
      <h6 class="HS_-_Head_Sub"><a name="2127116">retrieveFinally(info : RootInfo, finalStatus : ArchiveFinalStatus, cause : List&lt;String&gt;)</a></h6>
      <div class="B_-_Body"><a name="2127117">The retrieval process calls this as the last retrieval step, outside of the retrieve transaction. The </a><span class="p_-_parameter">finalStatus</span> parameter tells if the retrieve was successful. Use this plugin method to perform other actions on the storage. For example, deleting the file, or marking its status.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>