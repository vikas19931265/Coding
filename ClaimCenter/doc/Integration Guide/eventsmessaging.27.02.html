<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Messaging Overview</title>
    <link rel="StyleSheet" href="css/eventsmessaging.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>ClaimCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="p-messaging.html#2961060">Messaging</a> : <a class="WebWorks_Breadcrumb_Link" href="eventsmessaging.27.01.html#2961060">Messaging and Events</a> : Messaging Overview</span></div>
    <hr align="left" />
    <blockquote>
      <h3 class="H1_-_Heading_1"><a name="2961060">Messaging Overview</a></h3>
      <div class="B_-_Body"><a name="2270159">To understand this topic, it might help to get a high-level overview of terminology and an overview of events in ClaimCenter. The following subtopics summarizes important messaging concepts.</a></div>
      <h4 class="H2_-_Heading_2"><a name="4197660">Event</a></h4>
      <div class="B_-_Body"><a name="4197665">An event is an abstract notification of a change in ClaimCenter that might be interesting to an external system. An event most often represents a user action to application data, or an API that changed application data. For some (but not all) entities in the data model configuration files, if a user action or API adds, changes, or removes an entity instance, the system triggers an event. Each event has a name, which is a </a><span class="cv_-_computer_voice">String</span> value. </div>
      <div class="B_-_Body"><a name="4315629">For example, in ClaimCenter, adding a new check on a claim triggers an event. The event name is </a><span class="cv_-_computer_voice">"ClaimAdded"</span>.</div>
      <div class="B_-_Body"><a name="4197783">One user action or API call might trigger multiple events for different objects in one database transaction. In some cases, the object might have multiple events occur in one database transaction.</a></div>
      <div class="B_-_Body"><a name="4262947">Triggering an event triggers one call to the Event Fired rule set for each external system that is interested in that event. </a></div>
      <div class="B_-_Body"><a name="4263010">Event Fired rules for an event name run only if you tell ClaimCenter that at least one external system is interested in that event. To request that ClaimCenter run Event Fired rules for that event and that destination ID, see </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.03.html#3006454', '');" title="Message Destination Overview">“Message Destination Overview”</a>.</div>
      <div class="B_-_Body"><a name="4309132">Additionally, only entity types defined with the </a><span class="cv_-_computer_voice">&lt;events&gt;</span> tag by default generate added, changed, or deleted events. For more information, see <a href="javascript:WWHClickedPopup('config', 'entities.19.19.html#2664358', '');" title="&lt;events&gt;">“&lt;events&gt;” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'entities.19.19.html#2664358', '');" title="&lt;events&gt;">Configuration Guide</a></span>.</div>
      <h4 class="H2_-_Heading_2"><a name="4207393">Message</a></h4>
      <div class="B_-_Body"><a name="4197675">A message is information to send to an external system in response to an event. ClaimCenter can ignore the event or send one or more messages to each external system that cares about that event. In addition to an ID and some status information, each message has a </a><span class="e_-_emphasis">message&nbsp;payload</span>. The payload is the main data content of the message. The payload is <span class="cv_-_computer_voice">String</span> in the <span class="cv_-_computer_voice">Message.Payload</span> property.</div>
      <div class="B_-_Body"><a name="4197921">Your code creates messages in the Event Fired rule set. For more information, see </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.06.html#3961690', '');" title="Generating New Messages in Event Fired Rules">“Generating New Messages in Event Fired Rules”</a>. Because message creation impacts user response times, avoid unnecessarily large or complex messages if possible</div>
      <h4 class="H2_-_Heading_2"><a name="4307997">Message History</a></h4>
      <div class="B_-_Body"><a name="4307937">After a message is sent, the application converts a message (</a><span class="cv_-_computer_voice">Message</span>) object to a message history (<span class="cv_-_computer_voice">MessageHistory</span>) object. The message history object has the same properties as a message object. </div>
      <div class="B_-_Body"><a name="4308013">You can use the message history database table to understand the messaging history to your external systems. This can be useful to help understand problems.</a></div>
      <div class="B_-_Body"><a name="4308024">Additionally, message history objects are important when detecting duplicate messages. To report a duplicate message, you must find the message history object. Call the </a><span class="cv_-_computer_voice">reportDuplicate</span> method on the message history object, which represents the original message. See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.09.html#4016335', '');" title="Reporting Acknowledgements and Errors">“Reporting Acknowledgements and Errors”</a>.</div>
      <h4 class="H2_-_Heading_2"><a name="4207944">Messaging Destinations</a></h4>
      <div class="B_-_Body"><a name="4207945">A messaging destination is an external system to which to send messages. Generally speaking, a messaging destination represents one external system. Register one destination for each external system, even if that external system is used for multiple types of data. </a></div>
      <div class="B_-_Body"><a name="4207946">Register your messaging destinations in Studio. In the </a><span class="ui_-_UI_element">Messaging</span> editor, specify which classes implement the messaging plugin interfaces for that messaging destination. The most important message plugin interface is <span class="cv_-_computer_voice">MessageTransport</span>. The <span class="cv_-_computer_voice">MessageTransport</span> plugin interface is responsible for actually dispatching the message (most importantly, its payload) to your external system.</div>
      <div class="B_-_Body"><a name="4207947">Each destination registers a </a><span class="e_-_emphasis">list of event names</span> for which it wants notifications. Each destination may listen for different events compared to other destinations. The Event Fired rule set runs once for every combination of an event name and a destination interested in that event. To request that ClaimCenter run Event Fired rules for that event and that destination ID, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.03.html#3006454', '');" title="Message Destination Overview">“Message Destination Overview”</a>.</div>
      <div class="B_-_Body"><a name="4207954">If more than one messaging destination requests an event name, ClaimCenter runs the Event Fired rule set once for every destination that requested it. To determine which destination this event trigger is for, your Event Fired rules must check the </a><span class="cv_-_computer_voice">DestinationID</span> property of the message context object at run time. </div>
      <div class="B_-_Body"><a name="4280871">In the </a><span class="ui_-_UI_element">Messaging</span> editor there are other important settings for each destination, including:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ui_-_UI_element"><a name="4280897">Alternative Primary Entity</a></span> – See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4207620', '');" title="Messaging Overview">“Primary Entity and Primary Object”</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ui_-_UI_element"><a name="4280912">Message Without Primary </a></span>– See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.07.html#4084669', '');" title="Message Ordering and Multi-Threaded Sending">“How Destination Settings Affects Ordering”</a></div>
            </td>
          </tr>
        </table>
      </div>
      <h4 class="H2_-_Heading_2"><a name="4207420">Root Object</a></h4>
      <div class="B_-_Body"><a name="4207444">A root object for an event is the entity instance most associated with the event. This might be a small subobject or a more prominent high-level object.</a></div>
      <div class="B_-_Body"><a name="4318124">A root object for a message is the entity instance most associated with the message. This might be a small subobject or a more prominent high-level object.</a></div>
      <div class="B_-_Body"><a name="4318125">By default, the message’s root object is the same as the root object for the event that created the message in your Event Fired rules. This default makes sense in most cases. You can override this default for a message if desired. See </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.06.html#4348048', '');" title="Generating New Messages in Event Fired Rules">“Setting a Message Root Object or Primary Object”</a>.</div>
      <h4 class="H2_-_Heading_2"><a name="4207620">Primary Entity and Primary Object</a></h4>
      <div class="B_-_Body"><a name="4226052">A </a><span class="e_-_emphasis">primary entity</span> represents a type of high-level object that a Guidewire application uses to group and sort related messages. A <span class="e_-_emphasis">primary object</span> is a specific instance of a primary entity. Each Guidewire application specifies a default <span class="e_-_emphasis">primary entity</span> type for the application, or no default primary entity type. </div>
      <div class="B_-_Body"><a name="4250110">Additionally, messaging destinations can override the primary entity type, and that setting applies just to that messaging destination. Only specific entity types are supported for each Guidewire application.</a></div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="4208228">Determining which primary object, if any, applies for a messaging destination is critical to understanding how ClaimCenter orders messages. See </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4307737', '');" title="Messaging Overview">“Safe Ordering”</a> and <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.07.html#4253049', '');" title="Message Ordering and Multi-Threaded Sending">“Message Ordering and Multi-Threaded Sending”</a>.</div>
      <div class="B_-_Body"><a name="4315644">In ClaimCenter:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4315645">The default primary entity is </a><span class="cv_-_computer_voice">Claim</span>. Most objects are subobjects of a claim. An <span class="cv_-_computer_voice">Exposure</span> object is part of a claim. A <span class="cv_-_computer_voice">ClaimContact</span> object is part of a claim. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4315646">A messaging destination can specify the </a><span class="cv_-_computer_voice">Contact</span> entity as an alternative primary object, in which case that setting applies just to that messaging destination. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4315647">No other entity types can be alternative primary entities for a messaging destination.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="4315679">Some objects are not associated with any primary object. For example, </a><span class="cv_-_computer_voice">Catastrophe</span> and <span class="cv_-_computer_voice">User</span> objects are not associated with a single claim. Messages associated with such objects are called <span class="e_-_emphasis">non-safe-ordered messages</span>. See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4307737', '');" title="Messaging Overview">“Safe Ordering”</a> and <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.07.html#4253049', '');" title="Message Ordering and Multi-Threaded Sending">“Message Ordering and Multi-Threaded Sending”</a>.</div>
      <div class="B_-_Body"><a name="4208373">Do not confuse the </a><span class="e_-_emphasis">root object</span> for a message with the <span class="e_-_emphasis">primary object</span> associated with a message. The root object is the generally the object that triggered the event. The primary object is the highest-level object related to the root object. </div>
      <div class="B_-_Body"><a name="4295817">To configure how a message is associated with a primary entity, there are some automatic behaviors when you set the message root object. You can manually set the message root object and the primary entity properties for a message. See </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.06.html#4348048', '');" title="Generating New Messages in Event Fired Rules">“Setting a Message Root Object or Primary Object”</a>.</div>
      <h4 class="H2_-_Heading_2"><a name="4197681">Acknowledgement (ACK and NAK)</a></h4>
      <div class="B_-_Body"><a name="4197686">An acknowledgement is a formal response from an external system back to a ClaimCenter that declares how successfully the system processed the message:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4198306">A </a><span class="e_-_emphasis">positive acknowledgement </span>(ACK) means that the external system processed the message successfully. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4198325">A </a><span class="e_-_emphasis">negative acknowledgement</span> (NAK) means the external system failed to handle the message due to errors.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="4198367">It is very important for integration programmers to understand that ClaimCenter distinguishes between the following errors:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4236492">An error that throws a Gosu or Java exception during initial sending in the </a><span class="cv_-_computer_voice">MessageTransport</span> method called <span class="cv_-_computer_voice">send</span>. Errors during this phase typically indicate network errors or other similar retryable errors. If the <span class="cv_-_computer_voice">send</span> method throws an exception, ClaimCenter automatically retries sending the message multiple times.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4236452">An error reported from the external system, which are also called a NAK. </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="4198382">For more information about error handling, see </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.11.html#3138748', '');" title="Implementing Messaging Plugins">“Error Handling in Messaging Plugins”</a>.</div>
      <h4 class="H2_-_Heading_2"><a name="4307737">Safe Ordering</a></h4>
      <div class="B_-_Body"><a name="4307738">Safe ordering is a messaging feature that causes related messages to be received in the same order they were sent. This is called </a><span class="e_-_emphasis">safe order</span>. Messages are grouped by their related <span class="e_-_emphasis">primary object</span> for each messaging destination. For important definitions relevant to this topic, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4207620', '');" title="Messaging Overview">“Primary Entity and Primary Object”</a>.</div>
      <div class="B_-_Body"><a name="4307743">Messages send in creation order with other messages associated with that same primary object for that destination. Any messages associated with a primary object for that destination are called </a><span class="e_-_emphasis">safe-ordered</span> messages. The application waits for an acknowledgement before processing the next safe-ordered message for that same primary object for that destination. In other words, delays or errors for that destination block further sending of messages for that same destination for that same primary object.</div>
      <div class="B_-_Body"><a name="4315712">For example, by default ClaimCenter sends any messages associated with a claim to each destination grouped by claim and sent in creation order. These are </a><span class="e_-_emphasis">safe-ordered </span>messages. In Guidewire terminology, the <span class="e_-_emphasis">primary object</span> for ClaimCenter is a claim (a <span class="cvt_-_computer_voice_table">Claim</span> object). If a messaging destination sets <span class="cv_-_computer_voice">Contact</span> as its alternative <span class="e_-_emphasis">primary entity</span>, messages associated with a contact send grouped by contact for each messaging destination and sent in creation order. </div>
      <div class="B_-_Body"><a name="4315713">There are ClaimCenter objects that are not associated with a primary entity. For example, </a><span class="cv_-_computer_voice">Catastrophe</span>. All messages that are not associated with a claim (the primary object) are called <span class="e_-_emphasis">non-safe-ordered</span> messages. </div>
      <div class="B_-_Body"><a name="4307753">Not all messages are associated with a primary object. The logic for how and when to send these </a><span class="e_-_emphasis">non-safe-ordered messages</span> is different from the logic for safe-ordered messages. Additionally, the behavior varies based on the messaging destination configuration setting called <span class="ui_-_UI_element">Strict Mode</span>. For details, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.07.html#4253049', '');" title="Message Ordering and Multi-Threaded Sending">“Message Ordering and Multi-Threaded Sending”</a>.</div>
      <h4 class="H2_-_Heading_2"><a name="4307758">Transport Neutrality</a></h4>
      <div class="B_-_Body"><a name="4237509">ClaimCenter does not assume any specific type of transport or message formatting. </a></div>
      <div class="B_-_Body"><a name="4237531">Destinations deliver the message any way they want, including but not limited to the following:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="4237513">Submit the message by using remote API calls</a></span> –<span class="ri_-_run_in_header"> </span>Use a web service (SOAP) interface or a Java-specific interface to send a message to an external system.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="4350322">Submit the message to a guaranteed-delivery messaging system</a></span> –<span class="ri_-_run_in_header"> </span>For instance, a message queue. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="4237514">Save to special files in the file system</a></span> –<span class="ri_-_run_in_header"> </span>For large-scale batch handling, you could send a message by implementing writing data to local text files that are read by nightly batch processes. If you do this, remember to make your plugins thread-safe when writing to the files.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="4237515">Send e-mails</a></span> –<span class="ri_-_run_in_header"> </span>The destination might send e-mails, which might not guarantee delivery or order, depending on the type of mail system. This approach is acceptable for simple administrative notifications but is inappropriate for systems that rely on guaranteed delivery and message order, which includes most real-world installations. </div>
            </td>
          </tr>
        </table>
      </div>
      <h4 class="H2_-_Heading_2"><a name="3012350">Messaging Flow Overview</a></h4>
      <div class="B_-_Body"><a name="4198483">The high-level steps of event and message generation and processing are as follows. </a>As an example for this list, let us suppose you want to detect new checks so you can send the information to a check printing system.</div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><span class="ri_-_run_in_header"><a name="3749103">Application startup</a></span> –<span class="ri_-_run_in_header"> </span>At application startup, ClaimCenter checks its configuration information and constructs messaging destinations. Each destination registers for specific events for which it wants notifications. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4315741">In the earlier example, the destination registers for the </a><span class="cv_-_computer_voice">CheckAdded</span> and <span class="cv_-_computer_voice">CheckChanged</span> events.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="4237130">Users and APIs trigger messaging events</a></span> –<span class="ri_-_run_in_header"> </span>Events trigger after data changes. For example, a change to data in the user interface, or an outside system calls a web service that changes data. The messaging event represents the changes to application data as the entity commits to the database.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="4237131">Event Fired rules create messages</a></span> –<span class="ri_-_run_in_header"> </span>ClaimCenter runs the Event Fired rule set for each event name that triggers. ClaimCenter runs the rule set multiple times for an event name if multiple destinations listen for it. Your rules can choose to generate new messages. Messages have a text-based <span class="e_-_emphasis">message payload</span>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4315746">In ClaimCenter, for example you might write rules that check if the event name is </a><span class="cv_-_computer_voice">CheckAdded</span> or <span class="cv_-_computer_voice">CheckChanged</span>, and if certain other conditions occur. If so, the rules might generate a new message with an XML payload that describes the added check. The rules might also link entities with the message for later use.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="4233840">ClaimCenter sends message to a destination</a></span> –<span class="ri_-_run_in_header"> </span>Messages are put in a queue and handed one-by-one to the <span class="e_-_emphasis">messaging&nbsp;destination</span>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4315767">In ClaimCenter, a check printing destination might take an XML payload and submit the message to an external message queue to notify the external system of the check.</a></div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="4240534">ClaimCenter waits for an acknowledgement</a></span> –<span class="ri_-_run_in_header"> </span>The external system replies with an acknowledgement to the destination after it processes the message, and the destination’s messaging plugins process this information. If the message successfully sent, the messaging plugins submit an ACK and ClaimCenter sends the next message. For details of the messaging ordering system, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.07.html#4253049', '');" title="Message Ordering and Multi-Threaded Sending">“Message Ordering and Multi-Threaded Sending”</a>. The code that submits the acknowledgement might also make changes to application data, such as updating a messaging-specific property on a persisted object or advancing a workflow. If you change data, see the warnings in the section <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#3036501', '');" title="Messaging Overview">“Messaging Flow Details”</a>. Remember that you can also submit an error (a negative acknowledgement, a NAK) instead of a positive acknowledgement.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="4240541">Most messaging integration code that you write for a typical deployment is writing your Event Fired rules that create message payloads and writing </a><span class="cv_-_computer_voice">MessageTransport</span> plugin implementations to send messages. There are two other optional types of messaging plugins and discussed later.</div>
      <div class="B_-_Body"><a name="4237406">Once you write messaging plugin implementation classes, you register your new messaging plugin classes in Studio. Register your messaging plugin implementations first in the </a><span class="ui_-_UI_element">Plugins</span> editor and then in the <span class="ui_-_UI_element">Messaging</span> editor. For plugin interfaces that can have multiple implementations, which includes all messaging plugin interfaces, Studio asks you to <span class="e_-_emphasis">name</span> your plugin implementation when registering your plugin class. Use that <span class="e_-_emphasis">plugin implementation class name</span> when you configure the messaging destination in the <span class="ui_-_UI_element">Messaging</span> editor.</div>
      <h6 class="HS_-_Head_Sub"><a name="3656858">See Also</a></h6>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a href="javascript:WWHClickedPopup('config', 'studio_messaging.15.1.html#1178213', '');" title="Using the Messaging Editor" name="4237565">“Using the Messaging Editor” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'studio_messaging.15.1.html#1178213', '');" title="Using the Messaging Editor">Configuration Guide</a></span>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a href="javascript:WWHClickedPopup('config', 'studio_plugins.11.1.html#3595679', '');" title="Using the Plugins Registry Editor" name="4237625">“Using the Plugins Registry Editor” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'studio_plugins.11.1.html#3595679', '');" title="Using the Plugins Registry Editor">Configuration Guide</a></span>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a href="javascript:WWHClickedPopup('integration', 'plugins.15.01.html#2013370', '');" title="Plugin Overview" name="4237587">“Plugin Overview”</a>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.03.html#3006454', '');" title="Message Destination Overview" name="4237610">“Message Destination Overview”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <h4 class="H2_-_Heading_2"><a name="3036501">Messaging Flow Details</a></h4>
      <div class="B_-_Body"><a name="4308090">The following diagram illustrates the chronological flow of events and messaging, starting from the top of the diagram. Refer to the section following the diagram for a detailed explanation of each step.</a></div>
      <div class="F_-_Figure"><a name="4308094"><img class="Default" src="images/eventsmessaging.27.02.1.png" style="display: inline; float: none; left: 0.0; top: 0.0" alt="" /></a></div>
      <div class="B_-_Body"><a name="4308095">The following list describes a detailed chronological flow of event-related actions:</a></div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><span class="ri_-_run_in_header"><a name="4308100">Destination initialization at system startup</a></span> –<span class="ri_-_run_in_header"> </span>After the ClaimCenter application server starts, the application initializes all destinations. ClaimCenter saves a list of events for which each destination requested notifications. Because this happens at system startup, if you change the list of events or destination, you must restart ClaimCenter. Each destination encapsulates all the necessary behavior for that external system, but uses three different plugin interfaces to implement the destination. Each plugin handles different parts of what a destination does. The message request plugin handles message pre-processing. The message transport plugin handles message transport, and the message reply plugin handles message replies.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="3655067">Register new messaging plugins in Studio first in the Plugins editor. When you create a new implementation, Studio prompts you for a plugin interface name (in a picker) and, in some cases, for a plugin name. Use that plugin name in the Messaging editor in Studio to register each destination. Remember that you need to register your plugin in two different editors in Studio.</a></div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3753811">A user or an API changes something</a></span> –<span class="ri_-_run_in_header"> </span>A user action, API, or a batch process changed data in ClaimCenter.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4315792">For example, ClaimCenter triggers an event if you add an exposure to a claim, add a note to anything, or issue a payment. </a></div>
      <div class="LP_-_List_Para"><a name="4033820">It is critical to understand that the change does not fully commit to the database until </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#3570365', '');" title="Messaging Overview">step 4</a>. Any exceptions that occur before <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#3570365', '');" title="Messaging Overview">step 4</a> undo the change that triggered the event. In other words, unless all follow-up actions to the change succeed, the database transaction rolls back. For related information, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.03.html#3961747', '');" title="Message Destination Overview">“Messaging Database Transactions During Sending”</a>.</div>
      <div class="LP_-_List_Para"><span class="ri_-_run_in_header"><a name="4309321">ClaimCenter generates messaging events</a></span> –<span class="ri_-_run_in_header"> </span>The same action, such as a single change to the ClaimCenter database, might trigger <span class="e_-_emphasis">more</span> than one event. ClaimCenter checks whether each destination has listed each relevant event in its messaging configuration. For each messaging destination that listens for that event, ClaimCenter calls your Event Fired business rules. If multiple destinations want notifications for a specific event, ClaimCenter duplicates the event for each destination that wants that event. To the business rules, these duplicates look the same except with different <span class="e_-_emphasis">destination&nbsp;ID</span> properties. It is critical to understand that a change to ClaimCenter data might generate events for one destination but not for another destination. To change this list for destination, review the <span class="ui_-_UI_element">Messaging</span> editor in Studio and select the row for your destination. Additionally, only entity types defined with the <span class="cv_-_computer_voice">&lt;events&gt;</span> tag by default generate added, changed, or deleted events. For more information, see <a href="javascript:WWHClickedPopup('config', 'entities.19.19.html#2664358', '');" title="&lt;events&gt;">“&lt;events&gt;” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'entities.19.19.html#2664358', '');" title="&lt;events&gt;">Configuration Guide</a></span>.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="2996599">ClaimCenter invokes Event Fired rules (and they generate messages)</a></span> –<span class="ri_-_run_in_header"> </span>ClaimCenter calls the Event Fired rule set for each destination-event pair. Event Fired rules must rules check the event name and the messaging destination ID to determine whether to send a message for that event. Your Event Fired rules generate messages using the Gosu method <span class="cv_-_computer_voice">messageContext.createMessage(</span><span class="ps_-_parameter_in_code_snippets">payload</span><span class="cv_-_computer_voice">)</span>. The rule actions choose whether to generate a message, the order of multiple messages, and the text-based message <span class="e_-_emphasis">payload</span>. For more information, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.06.html#3961690', '');" title="Generating New Messages in Event Fired Rules">“Generating New Messages in Event Fired Rules”</a>. Your rules can use the following techniques:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><span class="ri_-_run_in_header"><a name="4188438">Optionally export an entity to XML using generated XSDs</a></span> –<span class="ri_-_run_in_header"> </span>Studio includes a tool that helps you export business data entities (and other types like Gosu classes) to XML. You can select which properties are required or optional for each integration point. You can export an XSD to describe the data interchange format you selected. Then, you can edit your Event Fired rules to generate a payload for the entity that conforms to your custom XSD. For more details, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.06.html#4348018', '');" title="Generating New Messages in Event Fired Rules">“Creating XML Payloads Using Guidewire XML (GX) Models”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4262329">The Guidewire XML (GX) modeler is a powerful tool for integrations. Create custom XML models that contain only the subset of entity object data that is appropriate for each integration point. It can output a custom XSD that your external system can use. You can also use GX models to parse (import) XML data into in-memory objects that describe the XML structure. See </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.06.html#4348018', '');" title="Generating New Messages in Event Fired Rules">“Creating XML Payloads Using Guidewire XML (GX) Models”</a>.</div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><span class="ri_-_run_in_header"><a name="4262336">Optionally use Gosu templates to generate the payload</a></span> – Rules can optionally use templates with embedded Gosu to generate message content. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><span class="ri_-_run_in_header"><a name="4237066">Optionally use Java classes (called from Gosu) to generate the payload</a></span> –<span class="ri_-_run_in_header"> </span>Rules can optionally use Java classes to generate the message content from Gosu business rules.<span class="e_-_emphasis"> </span>See <a href="javascript:WWHClickedPopup('gosu', 'java-gosu.09.1.html#2133774', '');" title="Calling Java from Gosu">“Calling Java from Gosu” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('gosu', 'java-gosu.09.1.html#2133774', '');" title="Calling Java from Gosu">Gosu Reference Guide</a></span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><span class="ri_-_run_in_header"><a name="4042029">Optional late binding</a></span> –<span class="ri_-_run_in_header"> </span>You can use a technique called <span class="e_-_emphasis">late binding</span> to include parameters in a message payload at message creation time but evaluate them immediately before sending. See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.08.html#3946497', '');" title="Late Binding Data in Your Payload">“Late Binding Data in Your Payload”</a> for details.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="4248330">Event Fired rules and messaging plugin implementations have limitations about what data you can change. See </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4367010', '');" title="Messaging Overview">“Important Entity Data Restrictions in Messaging Rules and Messaging Plugins”</a>.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3570365">New messages are added to the send queue</a></span> –<span class="ri_-_run_in_header"> </span>After all rules run, ClaimCenter adds any new messages to the send queue in the database. The submission of messages to the send queue is part of the same database transaction that triggered the event to preserve atomicity. If the transaction succeeds, all related messages successfully enter the send queue. If the transaction <span class="e_-_emphasis">fails</span>, the change rolls back including all messages added during that transaction. Messages might wait in this queue for a while, depending on the state of acknowledgements and the status of safe ordering of other messages (see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4006012', '');" title="Messaging Overview">step 5</a>). </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="4006012">On the batch server only, ClaimCenter dispatches messages to messaging destinations </a></span>–<span class="ri_-_run_in_header"> </span>ClaimCenter retrieves messages from the send queue and dispatches messages to destinations. The messaging plugins for each destination sends each message. For details of how ClaimCenter retrieves messages and orders them for sending, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4307737', '');" title="Messaging Overview">“Safe Ordering”</a> and <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.07.html#4253049', '');" title="Message Ordering and Multi-Threaded Sending">“Message Ordering and Multi-Threaded Sending”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4041893">To send a message, ClaimCenter finds the messaging destination’s transport plugin and calls its </a><span class="cv_-_computer_voice">send</span> method. The message transport plugin sends the message in whatever native transport layer is appropriate. See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4307758', '');" title="Messaging Overview">“Transport Neutrality”</a>. If the <span class="cv_-_computer_voice">send</span> method throws an exception, ClaimCenter automatically retries the message. </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	6.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3036519">Acknowledging messages</a></span> –<span class="ri_-_run_in_header"> </span>Some destination implementations know success or failure immediately during sending. For example, a messaging transport plugin might call a synchronous remote procedure call on a destination system before returning from its <span class="cv_-_computer_voice">send</span> method.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4006165">In contrast, a messaging destination might need to wait for an </a><span class="e_-_emphasis">asynchronous</span>, time-delayed reply from the destination to confirm that it processed the message successfully. For example, it might need to wait for an incoming message on an external messaging queue that confirms the system processed that message. </div>
      <div class="LP_-_List_Para"><a name="4248509">In either case, the messaging destination code or the external system must confirm that the message arrived safely by submitting an </a><span class="e_-_emphasis">acknowledgement</span> (an ACK) to ClaimCenter for that specific message. Alternatively, it can submit an error, also called a negative acknowledgement or <span class="e_-_emphasis">NAK</span>. You can submit an ACK or NAK in several places. For synchronous sending, submit it in your <span class="cv_-_computer_voice">MesssageTransport</span> plugin during the <span class="cv_-_computer_voice">send</span> method. For asynchronous sending, submit it in your <span class="cv_-_computer_voice">MessageReply</span> plugin. For asynchronous sending, an external system could optionally use a SOAP API to submit an acknowledgement or error.</div>
      <div class="LP_-_List_Para"><a name="4315807">If using messaging plugins to submit the ACK, you can also make changes to data during the ACK, such as updating properties on entities. For financials objects, acknowledgements of messages have special behavioral side effects, such as changing the status of a check. For more information, see </a><a href="javascript:WWHClickedPopup('integration', 'financials.29.01.html#3066382', '');" title="Financials Integration">“Financials Integration”</a>.</div>
      <div class="LP_-_List_Para"><a name="4262438">Event Fired rules and messaging plugin implementations have limitations about what data you can change. See </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4367010', '');" title="Messaging Overview">“Important Entity Data Restrictions in Messaging Rules and Messaging Plugins”</a>.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	7.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="4366996">After an ACK or NAK for a safe-ordered message, ClaimCenter dispatches the next related message</a></span> – An ACK for a safe-ordered message affects what messages are now sendable. If there are other messages for that destination in the send queue for the same primary object, ClaimCenter soon sends the next message for that primary object. For details of how messages are retrieved and ordered, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4307737', '');" title="Messaging Overview">“Safe Ordering”</a> and <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.07.html#4253049', '');" title="Message Ordering and Multi-Threaded Sending">“Message Ordering and Multi-Threaded Sending”</a>. Read that section for details of the setting called Strict Mode. Strict Mode affects whether ClaimCenter waits for acknowledgements for non-safe-ordered messages. </div>
            </td>
          </tr>
        </table>
      </div>
      <h4 class="H2_-_Heading_2"><a name="4367010">Important Entity Data Restrictions in Messaging Rules and Messaging Plugins</a></h4>
      <div class="B_-_Body"><a name="4368954">Event Fired rules and messaging plugin implementations have limitations about changing entity instance data. Messaging code in these locations must perform only the minimal data changes necessary for integration on the message entity. </a></div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="4374961">For data integrity and server reliability, you must carefully follow restrictions regarding what data you can change in Event Fired rules and messaging plugin implementations. </a></div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="4368956">Event Fired Rule Set Restrictions for Entity Data Changes</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="4375058">Entity changes in Event Fired must be very limited. Changes do not trigger validation rules, or pre-update rules. Read this topic carefully for additional restrictions.</a></div>
      <div class="B_-_Body"><a name="4368957">The following important restrictions apply to code within the Event Fired rule set:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4369991">In general, perform any data updates in your preupdate rules, not your Event Fired rules.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4374778">A property is safe to change in Event Fired rules only if it is messaging-specific and users can never modify it from the user interface, even indirectly. Carefully consider the role of every property you might modify. </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4369282">The only object safe to add is a new message using the </a><span class="cv_-_computer_voice">createMessage</span> method on the message context object. Never create new objects of any other types, even indirectly through other APIs.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4367957">Never delete objects.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4368901">Never call business logic APIs that might change entity data, even in edge cases.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4371248">Never rely on any entity data changes triggering these common rule sets:</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="4371249">Pre-update rule set </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="4371250">Validation rule set</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="4371561">Event Fired rule set</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4371562">These restrictions apply to all entity types, including custom entity types.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="4371572">Design your messaging rules carefully around these restrictions to avoid data corruption and logical errors that are difficult to diagnose.</a></div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="4371563">Messaging Plugin Restrictions for Entity Data Changes</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="4375155">Entity changes in messaging plugin code must be very limited. Changes do not trigger validation rules, pre-update rules, or concurrent data change exceptions. Read this topic carefully for additional restrictions.</a></div>
      <div class="B_-_Body"><a name="4367668">The following important restrictions apply to code triggered by a </a><span class="cv_-_computer_voice">MessageTransport</span> or <span class="cv_-_computer_voice">MessageReply</span> plugin implementation:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4373930">A property is safe to change only if it is messaging-specific and users can never modify it from the user interface, even indirectly. Carefully consider the role of every property you might modify.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4374060">You cannot create any new objects in general. In the default configuration, only the following objects are safe to create within a messaging plugin:</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="4374061">activities</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="4368441">notes</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="4368444">workflows and workflow items</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="4368455">work queues</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4375372">You cannot rely on preupdate rules or validation rules running for those objects.</a></div>
      <div class="LP_-_List_Para"><a name="4369051">All other object types are dangerous and unsupported to add from within messaging plugins.</a></div>
      <div class="LP_-_List_Para"><a name="4369598">If you modify the data model such that there are additional foreign keys on these objects, even these objects explicitly listed may be unsafe to add. For advice on specific changes, contact Guidewire Customer Support.</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4370804">Never delete objects.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4371398">You must not rely on any entity data changes eventually triggering these common rule sets:</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="4371065">Pre-update rule set </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="4371066">Validation rule set</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="4370809">Event Fired rule set for standard events </a><span class="p_-_parameter">ENTITY</span><span class="cv_-_computer_voice">Added</span>, <span class="p_-_parameter">ENTITY</span><span class="cv_-_computer_voice">Changed</span>, and <span class="p_-_parameter">ENTITY</span><span class="cv_-_computer_voice">Removed</span>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP2_-_List_Para_002c_Level_2"><a name="4374576">However, Event Fired rule set still triggers for events that you explicitly add. You can use the API </a><span class="cv_-_computer_voice">entity.addEvent("messageName")</span> to add events. ClaimCenter calls the Event Fired rule set once for each custom event for each messaging destination that listens for it. Your Event Fired code must conform to all restrictions in <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4368956', '');" title="Messaging Overview">“Event Fired Rule Set Restrictions for Entity Data Changes”</a>.</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4371613">Never call business logic APIs that might change entity data, even in edge cases.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4374925">From messaging plugin code, entity instance changes do not trigger concurrent data exceptions except in special rare cases. To avoid data integrity issues with concurrent changes, avoid changing data in these code locations. See later in this topic for additional guidance.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4374926">In some cases, consider adding or advancing a workflow as an alternative to direct data modifications from messaging code. The workflow can asynchronously perform code changes in a separate bundle outside your messaging-specific code. </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4352704">If you must update messaging-specific data, consider how absence of detecting concurrent data changes from messaging plugins might affect your extensions to the data model. For example, suppose you intend to modify an entity type to add a property with simple data. Instead, you could add a property with a foreign key to an instance of a custom entity type. First, create the instance of your custom entity type at an early part of the lifecycle of your main objects long before messaging code runs. As mentioned earlier, it is unsupported to create a entity instance in Event Fired rules or in messaging plugins. This restriction applies to all entity types, including custom entity types. In Event Fired rules or in messaging plugins, modify the messaging-specific entity instance. With this design, there is less chance of concurrent data change conflicts from a simple change on the main business entity instance from within the user interface.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="4374842">In a </a><span class="cv_-_computer_voice">MessageRequest</span> plugin implementation, do no data changes at all.</div>
      <div class="B_-_Body"><a name="4373357">Separate from the concurrent data exception differences mentioned earlier, there is an optional feature to </a><span class="e_-_emphasis">lock</span> related objects during messaging actions. If you use optional locking and code tries to access locked data (the primary entity instance or the message), the calling code waits for it to be unlocked. </div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="4374514">For maximum data integrity, enable optional entity locking during messaging. See </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.03.html#3961747', '');" title="Message Destination Overview">“Messaging Database Transactions During Sending”</a>. For maximum performance, disable optional entity locking during messaging.</div>
      <div class="B_-_Body"><a name="4371595">Design your messaging code carefully around these restrictions to avoid data corruption and logical errors that are difficult to diagnose.</a></div>
      <h4 class="H2_-_Heading_2"><a name="4236951">Database Transactions When Creating Messages</a></h4>
      <div class="B_-_Body"><a name="4236955">All steps up to and including adding messages to the send queue occur in one database transaction. In the list earlier in </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#3036501', '');" title="Messaging Overview">“Messaging Flow Details”</a>, this is <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#3753811', '');" title="Messaging Overview">step 2</a> through <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#3570365', '');" title="Messaging Overview">step 4</a>. All changes commit in the same transaction. This is always the same database transaction that triggers the initial event. </div>
      <div class="B_-_Body"><a name="4236979">The database transaction rolls back if any of the following occur:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4236994">Exceptions in rule sets that run before message creation</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4237006">Exceptions in Event Fired rules (where you create your messages)</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4236986">Exceptions in rule sets that run after Event Fired rules but before committing the bundle to the database</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4151271">Errors committing the bundle to the database, and remember that this bundle includes new </a><span class="cv_-_computer_voice">Message</span> objects</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="4151313">If any of these errors occur, ClaimCenter rolls back all messages added to the send queue in that transaction.</a></div>
      <div class="B_-_Body"><a name="3683560">There are special rules about database transactions during message sending at the destination level. See </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.03.html#3961747', '');" title="Message Destination Overview">“Messaging Database Transactions During Sending”</a>.</div>
      <h4 class="H2_-_Heading_2"><a name="4151357">Messaging in ClaimCenter Clusters</a></h4>
      <div class="B_-_Body"><a name="4151370">If you run ClaimCenter in a cluster, be aware that </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4308100', '');" title="Messaging Overview">step 1</a> through <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#3570365', '');" title="Messaging Overview">step 4</a> can occur on any ClaimCenter server within the cluster. ClaimCenter processes events on the same server as the user action or API call that triggered the event.</div>
      <div class="B_-_Body"><a name="4256472">Once a message is in the send queue (</a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4006012', '');" title="Messaging Overview">step 5</a> through <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.27.02.html#4366996', '');" title="Messaging Overview">step 7</a>), any further action with the message occurs <span class="e_-_emphasis">only</span> on the batch server.</div>
      <div class="B_-_Body"><a name="3540455">Consequently, the batch server is the only server on which messaging plugins run. Configure your batch server (and any backup batch servers) to communicate with your destination external systems. For example, remember to configure your firewalls accordingly including your backup batch servers.</a></div>
      <div class="B_-_Body"><a name="3006897">For ClaimCenter clusters, only the batch server actually uses your messaging plugins.</a></div>
      <h4 class="H2_-_Heading_2"><a name="3812734">Messaging Plugins Must Not Call SOAP APIs on the Same Server</a></h4>
      <div class="B_-_Body"><a name="3812735">In general, avoid calling locally-hosted SOAP APIs from within a plugin or the rules engine. Be careful about any SOAP calls to the same server. If the SOAP API hosted locally modifies entity data and commits the bundle, the current transaction does not always detect and reload local data. </a></div>
      <div class="B_-_Body"><a name="3812736">Instead, refactor your code to avoid this case. For example, write a Gosu class that performs a similar function as the web service but that does not commit the bundle. This type of refactoring also results in higher server performance. If you have questions about how to convert some particular use, locally-hosted SOAP APIs from plugins or rules, contact Customer Support. </a></div>
      <div class="B_-_Body"><a name="3812737">This is true for all types of local loopback SOAP calls to the same server. This includes the </a><span class="cv_-_computer_voice">soap.local.*</span> Gosu APIs, the SOAP API libraries, and any Studio-registered web services that call the same server as the client.</div>
      <div class="B_-_Body"><a name="3812738">Those limitations are true for all plugin code. In addition, there are messaging-specific limitations with this approach. Specifically, ClaimCenter locks the root entity for the message in the database. Any attempts to modify this entity from outside your messaging plugin (and SOAP APIs are included) result in concurrent data exceptions.</a></div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="3812742">Avoid calling locally-hosted SOAP APIs from within a plugin or the rules engine. There are various problems if you call SOAP APIs that modify entities that are currently in use, including but not limited to APIs that might change the message root entity.</a></div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>